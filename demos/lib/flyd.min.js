/* istanbul ignore file */
!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.flyd=e()}(this,function(){"use strict";var n=function(n,e){switch(n){case 0:return function(){return e.apply(this,arguments)};case 1:return function(n){return e.apply(this,arguments)};case 2:return function(n,t){return e.apply(this,arguments)};case 3:return function(n,t,r){return e.apply(this,arguments)};case 4:return function(n,t,r,u){return e.apply(this,arguments)};case 5:return function(n,t,r,u,a){return e.apply(this,arguments)};case 6:return function(n,t,r,u,a,o){return e.apply(this,arguments)};case 7:return function(n,t,r,u,a,o,i){return e.apply(this,arguments)};case 8:return function(n,t,r,u,a,o,i,s){return e.apply(this,arguments)};case 9:return function(n,t,r,u,a,o,i,s,f){return e.apply(this,arguments)};case 10:return function(n,t,r,u,a,o,i,s,f,d){return e.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}},e=Object.freeze({default:n,__moduleExports:n});var t=function(n){return null!=n&&"object"==typeof n&&!0===n["@@functional/placeholder"]},r=Object.freeze({default:t,__moduleExports:t}),u=r&&t||r;var a=function(n){return function e(t){return 0===arguments.length||u(t)?e:n.apply(this,arguments)}},o=Object.freeze({default:a,__moduleExports:a}),i=o&&a||o;var s=function(n){return function e(t,r){switch(arguments.length){case 0:return e;case 1:return u(t)?e:i(function(e){return n(t,e)});default:return u(t)&&u(r)?e:u(t)?i(function(e){return n(e,r)}):u(r)?i(function(e){return n(t,e)}):n(t,r)}}},f=Object.freeze({default:s,__moduleExports:s}),d=e&&n||e;var c=function n(e,t,r){return function(){for(var a=[],o=0,i=e,s=0;s<t.length||o<arguments.length;){var f;s<t.length&&(!u(t[s])||o>=arguments.length)?f=t[s]:(f=arguments[o],o+=1),a[s]=f,u(f)||(i-=1),s+=1}return i<=0?r.apply(this,a):d(i,n(e,a,r))}},l=Object.freeze({default:c,__moduleExports:c}),p=l&&c||l,h=(f&&s||f)(function(n,e){return 1===n?i(e):d(n,p(n,[],e))}),v=Object.freeze({default:h,__moduleExports:h}),g=v&&h||v;function m(){return!0}var y,_=[],b=[],C=-1,O=!1,x={};function j(n,e){var t,r,u,a,o=N([],m);for(u=[],a=[],t=0;t<e.length;++t)void 0!==e[t]&&(u.push(e[t]),void 0!==e[t].end&&a.push(e[t].end));return(r=N(u,n)).depsChanged=[],r.fnArgs=r.deps.concat([r,r.depsChanged]),r.end=o,o.listeners.push(r),k(a,o),o.deps=a,P(r),r}function E(n){return x.map(n,this)}function V(n){return n(this)}function z(n){return M(n,this)}function M(n,e){var t=x.stream(1),r=x.on(function(){var n=t()-1;t(n),n<=0&&t.end(!0)});r(e.end);var u=x.stream(),a=x.combine(function(e,a){u.end(!0);var o=n(e());t(t()+1),r(o.end),u=x.map(a,o)},[e]);return x.endsOn(t.end,a),a}function w(n,e){return j(function(n,e,t){t(n.val(e.val))},[e,n])}function A(n){return w(n,this)}function U(n){return w(this,n)}function q(){return"stream("+this.val+")"}function S(){function n(e){return 0===arguments.length?n.val:(function n(e,t){e.val=t;e.hasVal=!0;void 0===y?(O=!0,function(n){var e,t,r,u=n.listeners;for(e=0;e<u.length;++e)(r=u[e]).end===n?G(r):(void 0!==r.depsChanged&&r.depsChanged.push(n),r.shouldUpdate=!0,F(r));for(;C>=0;--C)!0===(t=b[C]).shouldUpdate&&P(t),t.queued=!1}(e),_.length>0?J():O=!1):y===e?function(n,e){var t,r;for(t=0;t<e.length;++t)(r=e[t]).end!==n?(void 0!==r.depsChanged&&r.depsChanged.push(n),r.shouldUpdate=!0):G(r)}(e,e.listeners):_.push(function(){n(e,t)})}(n,e),n)}return n.hasVal=!1,n.val=void 0,n.vals=[],n.listeners=[],n.queued=!1,n.end=void 0,n.ap=A,n["fantasy-land/map"]=n.map=E,n["fantasy-land/ap"]=U,n["fantasy-land/of"]=n.of=x.stream,n["fantasy-land/chain"]=n.chain=z,n.pipe=V,n.constructor=x.stream,n.toJSON=function(){return n.val},n.toString=q,n}function N(n,e){var t=S();return t.fn=e,t.deps=n,t.depsMet=!1,t.depsChanged=n.length>0?[]:void 0,t.shouldUpdate=!1,k(n,t),t}function P(n){var e;if(!(!0!==n.depsMet&&(e=n,e.depsMet=e.deps.every(function(n){return n.hasVal}),!e.depsMet)||void 0!==n.end&&!0===n.end.val))if(void 0===y){y=n,n.depsChanged&&(n.fnArgs[n.fnArgs.length-1]=n.depsChanged);var t=n.fn.apply(n.fn,n.fnArgs);void 0!==t&&n(t),y=void 0,void 0!==n.depsChanged&&(n.depsChanged=[]),n.shouldUpdate=!1,!1===O&&J()}else _.push(function(){P(n)})}function F(n){var e,t=n.listeners;if(!1===n.queued){for(n.queued=!0,e=0;e<t.length;++e)F(t[e]);b[++C]=n}}function J(){for(O=!0;_.length>0;){_.shift()()}O=!1}function k(n,e){for(var t=0;t<n.length;++t)n[t].listeners.push(e)}function B(n,e){e[e.indexOf(n)]=e[e.length-1],e.length--}function D(n){for(var e=0;e<n.deps.length;++e)B(n,n.deps[e].listeners);n.deps.length=0}function G(n){void 0!==n.deps&&D(n),void 0!==n.end&&D(n.end)}function H(){}return x.stream=function(n){var e=N([],m),t=S();return t.end=e,t.fnArgs=[],e.listeners.push(t),arguments.length>0&&t(n),t},x.stream["fantasy-land/of"]=x.stream.of=x.stream,x.combine=g(2,j),x.isStream=function(n){return!!((e=n)&&e.constructor&&e.call&&e.apply)&&"hasVal"in n;var e},x.immediate=function(n){return!1===n.depsMet&&(n.depsMet=!0,P(n)),n},x.endsOn=function(n,e){return D(e.end),n.listeners.push(e.end),e.end.deps.push(n),e},x.map=g(2,function(n,e){return j(function(e,t){t(n(e.val))},[e])}),x.chain=g(2,M),x.ap=g(2,w),x.on=g(2,function(n,e){return j(function(e){n(e.val)},[e])}),x.scan=g(3,function(n,e,t){var r=j(function(t,r){r(e=n(e,t.val))},[t]);return r.hasVal||r(e),r}),x.merge=g(2,function(n,e){var t=x.immediate(j(function(n,e,t,r){r[0]?t(r[0]()):n.hasVal?t(n.val):e.hasVal&&t(e.val)},[n,e]));return x.endsOn(j(function(){return!0},[n.end,e.end]),t),t}),x.transduce=g(2,function(n,e){return n=n(new H),j(function(e,t){var r=n["@@transducer/step"](void 0,e.val);return r&&!0===r["@@transducer/reduced"]?(t.end(!0),r["@@transducer/value"]):r},[e])}),x.curryN=g,x.fromPromise=function(n){var e=x.stream();return n.then(function(n){e(n),e.end(!0)}),e},x.flattenPromise=function(n){return j(function(n,e){n().then(e)},[n])},H.prototype["@@transducer/init"]=function(){},H.prototype["@@transducer/result"]=function(){},H.prototype["@@transducer/step"]=function(n,e){return e},x});
