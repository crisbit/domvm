// https://github.com/leeoniya/domvm
("object"===typeof module&&"object"===typeof module.exports&&function(n){module.exports=n()}||"function"===typeof define&&function(n){define("domvm",n)}||function(n){window.domvm=n()})(function(){return{}});(function(n){var u="undefined"==typeof window?{}:window,r={TYPE_ELEM:1,TYPE_TEXT:2,isArr:function(l){return l instanceof Array},isVal:function(l){l=typeof l;return"string"===l||"number"===l},isObj:function(l){return"object"===typeof l&&null!==l&&!r.isArr(l)},isFunc:function(l){return"function"===typeof l},execAll:function(l,n){l.forEach(function(l){return l.apply(null,n)})},insertArr:function(l,n,p,t){l.splice.apply(l,[p,t].concat(n))},isEvProp:function(l){return"on"===l.substr(0,2)},camelDash:function(l){return l.replace(/([a-z])([A-Z])/g,
"$1-$2").toLowerCase()},raft:function(l){function n(){p=0;l.apply(t,r)}if(!u.requestAnimationFrame)return l;var p,t,r;return function(){t=this;r=arguments;p||(p=u.requestAnimationFrame(n))}}};domvm.util=r})(domvm);(function(n){function u(a,c,d,h,b,g,k){function e(a,c,b){g=a;k=c;return n(b,!1)}function n(a,b){f.execAll(m.events.willRedraw);m.imp=null!=a?a:h;m.refs={};var e=m.node,q=m.render.call(c,m.imp),q=w(q,g,k,m);q.key=f.isVal(d)?d:q.key;q.vm=m;m.node=q;var v=e;if(e&&(q.type!==e.type||q.tag!==e.tag))var v=null,E=!0;p(q,v);g&&(g.body[k]=q);!1!==b&&(e&&l(e),!e&&F||t(q),E&&(e.el.parentNode.replaceChild(q.el,e.el),e.el=null));setTimeout(function(){var a=m,b;for(b in a.refs)a.refs[b]=a.refs[b].el;f.execAll(m.events.didRedraw)},
0);return m}function v(a){var b=null,c=a.split(":");2==c.length&&(a=c[0],b=+c[1]);var c=Array.prototype.slice.call(arguments,1),d=m.node;if(null!==b){for(;b&&d.parent;)d=d.parent,d.vm&&b--;(b=(b=d.vm?d.vm.events:null)?b[a]:null)&&b.apply(null,c)}else for(;d&&(!d.vm||!(b=(b=d.vm.events)?b[a]:null)||!1!==b.apply(null,c));)d=d.parent}var F=!g;f.isArr(a)&&(c=a[1],d=a[2],h=a[3],a=a[0]);!1===d&&(h=c,d=c=null);var m={exp:{},imp:h||{},node:null,view:[a,c,d],render:null,on:function(a,b){if(b)m.events[a].push(b);
else for(var c in a)m.events[c].push(a[c])},events:{willRedraw:[],didRedraw:[],willDestroy:[],didDestroy:[]},redraw:x.useRaf?f.raft(n):n,patch:function(a,b){var c=a.parent,d=p(w(b,c,a.idx,m),a);c.body[a.idx]=d;var e=d.key;f.isVal(e)&&(c.keyMap[e]=d)},emit:v,refs:{},mount:function(a){t(m.node);a.insertBefore(m.node.el,null);return m},attach:function(a){r(m.node,a);return m},destroy:function(a){f.execAll(m.events.willDestroy);if(g)if(a){for(a=k+1;a<g.body.length;a++){var b=g.body[a];b.idx=a-1;b.vm&&
b.vm.updIdx(b.idx)}g.body.splice(k,1)}else g.body[k]=null;l(m.node,!0);m.node.vm=null;f.execAll(m.events.didDestroy)},moveTo:e,updIdx:function(a){k=a}};m.events._redraw=m.redraw;m.render=a.call(m.exp,m,c,d,h);v.redraw=function(a){a=f.isVal(a)?a:1E3;v("_redraw:"+a)};return g?e(g,k,h):n(h)}function r(a,c){a.el=c;if(f.isArr(a.body))for(var d=0;d<a.body.length;d++)r(a.body[d],c.childNodes[d])}function l(a,c){f.isArr(a.body)&&(a.body.forEach(function(a,c){a&&(a.vm&&!a.moved?a.vm.destroy():a.el&&a.el.parentNode?
a.el.parentNode.removeChild(a.el):l(a))}),a.body=null);a.vm=null;c&&a.el&&(a.el.parentNode.removeChild(a.el),a.el=null)}function w(a,c,d,h){var b=a;a={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,tag:null,ns:null,guard:!1,raw:!1,props:null,el:null,keyMap:null,body:null};f.isFunc(b)&&(b=b());if(f.isArr(b)&&b.length){a.type=f.TYPE_ELEM;if(1<b.length){var g=1;f.isObj(b[1])&&(a.props=b[1],g=2);a.body=b.length==g+1?f.isVal(b[g])?b[g]:f.isFunc(b[g])?b[g]():b.slice(g):b.slice(g)}b=b[0];if(/[.#]/.test(b)){if(b=
G(b),a.tag=b.tag,b.id||b["class"])a.props=a.props||{},a.props.id=b.id,a.props["class"]=b["class"]}else a.tag=b;if(a.props){var b=a.props,k;for(k in b)f.isEvProp(k)?b[k]=H(b[k],h.view[1]||null):f.isFunc(b[k])&&("href"==k?(b.onclick=b[k],b.href=b[k].url):b[k]=b[k]());if(f.isObj(b.style))for(var e in b.style)k=b.style[e],f.isFunc(k)&&(b.style[e]=k());a.key=f.isVal(b._key)?b._key:f.isVal(b._ref)?b._ref:f.isVal(b.id)?b.id:f.isVal(b.name)?b.name:null;b._ref&&(a.ref=b._ref);b._raw&&(a.raw=!0);b._guard&&
(a.guard=!0);b._ref=b._key=b._raw=b._guard=null}}else f.isVal(b)&&(a.type=f.TYPE_TEXT,a.body=b);null!==a.ref&&(h.refs[a.ref]=a);a.parent=c;a.idx=d;a.ns=c&&c.ns?c.ns:"svg"===a.tag||"math"===a.tag?a.tag:null;if(f.isArr(a.body)){c={};d=!1;e=0;for(k=a.body.length;e<k;e++){var b=a.body[e],l=g=null,n=!1,p=!1;f.isFunc(b)&&(b=b());if(null==b)n=!0;else{var m=f.isArr(b),r=m?!1:f.isObj(b);if(m)b.length?f.isArr(b[0])?p=!0:f.isFunc(b[0])?g=b[2]:(l=w(b,a,e,h),g=l.key):n=!0;else if(r)if(f.isFunc(b.redraw))b.moveTo(a,
e),l=b.node,g=b.view[2];else{a.body[e--]=""+b;continue}else""===b?n=!0:0<e&&a.body[e-1].type===f.TYPE_TEXT?(a.body[e-1].body+=""+b,n=!0):l=w(""+b,a,e,h)}n||p?(p?f.insertArr(a.body,b,e,1):a.body.splice(e,1),k=a.body.length,e--):(f.isVal(g)&&(c[g]=e,d=!0),a.body[e]=l||b)}d&&(a.keyMap=c)}return a}function p(a,c){c&&I(c,a);f.isArr(a.body)&&a.body.forEach(function(d,h){var b=f.isArr(d);if(c){var g=D(d,a,c);if(null!==g){var k=g[1],g=c.body[g[0]];b&&g.vm?2===k?g.vm.moveTo(a,h,d[3]):1===k&&u(d[0],d[1],d[2],
d[3],d[4],a,h):a.body[h]=p(d,g);return}}b?u(d[0],d[1],d[2],d[3],d[4],a,h):a.body[h]=p(d)});return a}function t(a){var c=!a.el;a.type==f.TYPE_ELEM?(c&&(a.el=a.ns?y.createElementNS(J[a.ns],a.tag):y.createElement(a.tag),a.props&&A(a)),f.isArr(a.body)?a.body.forEach(t):c&&f.isVal(a.body)&&(a.raw?a.el.innerHTML=a.body:a.el.textContent=a.body)):a.type==f.TYPE_TEXT&&c&&(a.el=y.createTextNode(a.body));a.el._node=a;(c=a.parent)&&c.el&&c.el.childNodes[a.idx]!==a.el&&c.el.insertBefore(a.el,c.el.childNodes[a.idx])}
function D(a,c,d,h,b){var g=f.isArr(a),k=g?a[2]||null:a.key,e=d.keyMap,l=c.keyMap;d=d.body;c=c.body;if(null!==k&&e&&f.isVal(e[k]))return[e[k],2];h=h||0;if(h>d.length-1)return null;b=0===b?0:b||d.length-1;for(k=null;h<=b;h++)if(e=d[h],null!==e&&e.el)if(g&&e.vm){if(e.vm.view[0]===a[0]){if(e.vm.view[1]===a[1])return[h,2];var n=!1;if(x.viewScan)for(var p=0;p<c.length;p++){var m=c[p];if(!m.el&&m.vm&&m.vm.view[0]===e.vm.view[0]&&m.vm.view[1]===e.vm.view[1]){n=!0;break}}n||k||!l||f.isVal(l[e.key])||(k=[h,
1])}}else if(!(a.type!==e.type||a.type!==f.TYPE_TEXT&&(null===a.tag||a.tag!==e.tag)||null!==e.key&&l&&f.isVal(l[e.key])))return[h,1];return k}function I(a,c){c.el=a.el;a.el=null;if(c.type===f.TYPE_TEXT&&c.body!==a.body)c.el.nodeValue=c.body;else{A(c,a);var d=!f.isArr(c.body),h=!f.isArr(a.body);d&&c.body!==a.body?h&&c.el.firstChild?c.el.firstChild.nodeValue=c.body:c.raw?c.el.innerHTML=c.body:c.el.textContent=c.body:h&&!d&&(c.el.textContent="");a.moved=!0}}function G(a){if(a in z)return z[a];var c=
{tag:null,id:null,"class":null};c.tag=a.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,function(a,f,b,g){b&&(c.id=b);g&&(c["class"]=g.replace(/\./g," ").trim());return f||"div"});return z[a]=c}function H(a,c){return function(d){var h;if(f.isFunc(a))h=a.call(c,d);else if(f.isObj(a))for(var b in a)d.target.matches(b)&&(h=a[b].call(c,d));!1===h&&(d.preventDefault(),d.stopPropagation())}}function A(a,c){var d=!c;c=c||{};if(c.props||a.props){var h=c.props||{},b=a.props||{},g=h.style,k=b.style;
if(f.isObj(g)||f.isObj(k))B(a.el,g||{},k||{},K,L,a.ns,d),h.style=b.style=null;B(a.el,h,b,M,C,a.ns,d);k&&(b.style=k)}}function B(a,c,d,f,b,g,k){for(var e in d)null!==d[e]&&(e in c&&d[e]===c[e]||f(a,e,d[e],g,k));for(e in c)null!==c[e]&&(e in d||b(a,e,g,k))}function K(a,c,d){a.style[c]=isNaN(d)||N[c]?d:d+"px"}function L(a,c){a.style[c]=""}function M(a,c,d,h,b){"."===c[0]?(c=c.substr(1),"svg"===h?a[c].baseVal=d:a[c]=d):"class"===c?a.className=d:"id"===c||f.isEvProp(c)?a[c]=d:!1===d?C(a,c,h,b):(!0===d&&
(d=""),a.setAttribute(c,d))}function C(a,c,d,h){h||("."===c[0]?(c=c.substr(1),"svg"===d?a[c].baseVal=null:a[c]=null):"class"===c?a.className="":"id"===c||f.isEvProp(c)?a[c]=null:a.removeAttribute(c))}var J={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},z={},y="undefined"==typeof document?{}:document,N={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,
"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},x={useRaf:!0,viewScan:!1,useDOM:!1};n.view=u;n.config=function(a){x=a};var f=n.util;return n})(domvm);
