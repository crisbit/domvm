/*
 https://github.com/leeoniya/domvm
*/
("undefined"!==typeof global?global:this).domvm={};(function(v){var w="undefined"==typeof window?{}:window,p={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},r={TYPE_ELEM:1,TYPE_TEXT:2,isArr:function(b){return b instanceof
Array},isVal:function(b){b=typeof b;return"string"===b||"number"===b},isObj:function(b){return"object"===typeof b&&null!==b&&!r.isArr(b)},isFunc:function(b){return"function"===typeof b},isProm:function(b){return"object"===typeof b&&r.isFunc(b.then)},execAll:function(b,f){b&&(r.isArr(b)?b:[b]).forEach(function(b){return b.apply(null,f)})},insertArr:function(b,f,l,d){b.splice.apply(b,[l,d].concat(f))},isEvProp:function(b){return"on"===b.substr(0,2)},camelDash:function(b){return b.replace(/([a-z])([A-Z])/g,
"$1-$2").toLowerCase()},autoPx:function(b,f){return isNaN(f)||p[b]?f:f+"px"},raft:function(b){function f(){l=0;b.apply(d,g)}if(!w.requestAnimationFrame)return b;var l,d,g;return function(){d=this;g=arguments;l||(l=w.requestAnimationFrame(f))}}};v.util=r})(domvm);(function(v){function w(a,e){return!1===e?null:null==a||null!=e&&!0!==e?e:a}function p(a,e,x,u,c,A){function k(a,c,e){if(e)a[c]=a[c]||[],a[c].push(e);else for(var b in c)a[b]=a[b]||[],a[b].push(c[b])}function h(a,e,b){c=a;A=e;n.update(b,!1);return q(0,!1)}function q(a,u){if(a){for(var h=n;a--&&h.parent;)h=h.parent;h.redraw(0,!0);return h.vm}n.hooks&&m.execAll(n.hooks.willRedraw);n.refs={};var h=n.node,k=n.render.call(n.api,n,e,x),k=l(k,c,A,n);k.key=m.isVal(x)?x:k.key;k.vm=n;n.node=k;for(var f="^"===
(""+k.key)[0]?k.key.substr(1):null,t=c;t;)t.vm&&(n.parent||(n.parent=t.vm),null!==f&&(t.vm.refs[f]=k)),t=t.parent;if((f=h)&&(k.type!==h.type||k.tag!==h.tag))var f=null,F=!0;d(k,f);c&&(c.body[A]=k);!1!==u&&(h&&b(h),!h&&E||g(k,null,k.el),F&&(h.el.parentNode.replaceChild(k.el,h.el),h.el=null));Promise.resolve().then(function(){n.hooks&&m.execAll(n.hooks.didRedraw)});return n}function f(a){n.hooks&&m.execAll(n.hooks.willUnmount);if(c)if(a){for(a=A+1;a<c.body.length;a++){var e=c.body[a];e.idx=a-1;e.vm&&
e.vm.updIdx(e.idx)}c.body.splice(A,1)}else c.body[A]=null;b(n.node,!0);n.node.vm=null;n.hooks&&m.execAll(n.hooks.didUnmount)}var E=!c;m.isArr(a)&&(e=a[1],x=a[2],u=a[3],a=a[0]);x=w(e,x);var n={api:{},node:null,view:[a,x],model:e,opts:u||{},render:null,update:function(a,c){null==a||null!=x&&(m.isVal(x)||x===e)||(e=n.model=a);return!1!==c?q(0):n},on:function(a,c){k(n.events,a,c)},hook:function(a,c){n.hooks=n.hooks||{};k(n.hooks,a,c)},events:{},hooks:null,redraw:D.useRaf?m.raft(q):q,patch:function(a,
c){var e=a.parent,b=d(l(c,e,a.idx,n),a);e.body[a.idx]=b;b=b.key;m.isVal(b)&&(e.keyMap[b]=a.idx)},emit:function(a){for(var c=Array.prototype.slice.call(arguments,1),e=n;e;){if(e.events[a]){m.execAll(e.events[a],c);break}e=e.parent}},refs:{},parent:null,mount:function(a,c){n.hooks&&m.execAll(n.hooks.willMount);c&&(a.textContent="");g(n.node,c?a:null);c||a.insertBefore(n.node.el,null);n.hooks&&m.execAll(n.hooks.didMount);return n},attach:function(a){r(n.node,a);return n},unmount:function(){y(n.hooks,
"Unmount",f,[])},moveTo:h,updIdx:function(a){A=a}};u&&u.hooks&&n.hook(u.hooks);m.execAll(C,[n]);n.render=a.call(n.api,n,e,x);return c?h(c,A):q(0)}function r(a,e){a.el=e;if(m.isArr(a.body))for(var b=0;b<a.body.length;b++)r(a.body[b],e.childNodes[b])}function b(a,e){m.isArr(a.body)&&(a.body.forEach(function(a,e){a&&(a.vm&&!a.moved?a.vm.unmount():b(a,!0))}),a.body=null);a.vm=null;e&&a.el&&a.el.parentNode&&y(a.hooks,"Remove",f,[a])}function f(a){a.el.parentNode.removeChild(a.el);a.el=null}function l(a,
e,b,u){var c=a;a={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,hooks:null,tag:null,ns:null,guard:!1,raw:!1,props:null,el:null,keyMap:null,body:null};m.isFunc(c)&&(c=c());if(m.isArr(c)&&c.length){a.type=m.TYPE_ELEM;if(1<c.length){var d=1;m.isObj(c[1])&&(a.props=c[1],d=2);a.body=c.length==d+1?m.isVal(c[d])?c[d]:m.isFunc(c[d])?c[d]():c.slice(d):c.slice(d)}c=c[0];if(/[.#]/.test(c)){if(c=L(c),a.tag=c.tag,c.id||c["class"])a.props=a.props||{},a.props.id=c.id,a.props["class"]=c["class"]}else a.tag=
c;if(a.props){var c=a.props,k;for(k in c)m.isEvProp(k)?c[k]=E(c[k],u.opts.evctx||u.model||null,a,u):m.isFunc(c[k])&&("href"==k?(c.onclick=c[k],c.href=c[k].path):c[k]=c[k]());if(m.isObj(c.style))for(var h in c.style)k=c.style[h],m.isFunc(k)&&(c.style[h]=k());m.isObj(c._hooks)&&(a.hooks=c._hooks,c._hooks=null);a.key=m.isVal(c._key)?c._key:m.isVal(c._ref)?c._ref:m.isVal(c.id)?c.id:m.isVal(c.name)?c.name:null;c._ref&&(a.ref=c._ref);c._raw&&(a.raw=!0);c._data&&(a.data=c._data);c._guard&&(a.guard=!0);c._ref=
c._key=c._raw=c._data=c._guard=null}}else m.isVal(c)&&(a.type=m.TYPE_TEXT,a.body=c);null!==a.ref&&(u.refs[a.ref]=a);a.parent=e;a.idx=b;a.ns=e&&e.ns?e.ns:"svg"===a.tag||"math"===a.tag?a.tag:null;if(m.isArr(a.body)){e={};b=!1;h=0;for(k=a.body.length;h<k;h++){var c=a.body[h],g=d=null,q=!1,f=!1;m.isFunc(c)&&(c=c());if(null==c)q=!0;else{var n=m.isArr(c),t=n?!1:m.isObj(c);if(n)c.length?m.isArr(c[0])?f=!0:m.isFunc(c[0])?d=c[2]:(g=l(c,a,h,u),d=g.key):q=!0;else if(t)if(m.isFunc(c.redraw))c.moveTo(a,h),g=c.node,
d=c.view[2];else{a.body[h--]=""+c;continue}else""===c?q=!0:0<h&&a.body[h-1].type===m.TYPE_TEXT?(a.body[h-1].body+=""+c,q=!0):g=l(""+c,a,h,u)}q||f?(f?m.insertArr(a.body,c,h,1):a.body.splice(h,1),k=a.body.length,h--):(m.isVal(d)&&(e[d]=h,b=!0),a.body[h]=g||c)}b&&(a.keyMap=e)}return a}function d(a,e){e&&y(a.hooks,"Recycle",t,[e,a]);if(m.isArr(a.body)){var b=0;a.body.forEach(function(u,c){var g=m.isArr(u);if(e){var k=F(u,a,e,b);if(null!==k){var h=k[0],k=k[1];h===b&&b++;h=e.body[h];g&&h.vm?2===k?h.vm.moveTo(a,
c,u[1]):1===k&&p(u[0],u[1],u[2],u[3],a,c):a.body[c]=d(u,h);return}}g?p(u[0],u[1],u[2],u[3],a,c):a.body[c]=d(u)})}return a}function g(a,e,b){var d=!a.el;if(a.type==m.TYPE_ELEM)if(d&&(a.el=e&&e.nodeName?e:a.ns?G.createElementNS(M[a.ns],a.tag):G.createElement(a.tag),a.props&&J(a)),m.isArr(a.body)){e=0;for(var c=a.el.firstChild;e<a.body.length;e++)c=g(a.body[e],null,c)?c:c.nextSibling||null}else m.isVal(a.body)&&(a.raw?a.el.innerHTML=a.body:d&&(a.el.textContent=a.body));else a.type==m.TYPE_TEXT&&d&&(a.el=
G.createTextNode(a.body));a.el._node=a;if(b===a.el)return!1;if((e=a.parent)&&e.el)return y(a.hooks,d?"Insert":"Reinsert",q,[a,b]),!0}function q(a,e){a.parent.el.insertBefore(a.el,e)}function F(a,e,b,d,c){var g=m.isArr(a),k=g?a[2]||null:a.key,h=b.keyMap,q=e.keyMap;b=b.body;e=e.body;if(null!==k&&h&&m.isVal(h[k]))return[h[k],2];d=d||0;if(d>b.length-1)return null;c=0===c?0:c||b.length-1;for(k=null;d<=c;d++)if(h=b[d],null!==h&&h.el)if(g&&h.vm){if(h.vm.view[0]===a[0]){if(h.vm.view[1]===w(a[1],a[2]))return[d,
2];var l=!1;if(D.viewScan)for(var f=0;f<e.length;f++){var n=e[f];if(!n.el&&n.vm&&n.vm.view[0]===h.vm.view[0]&&n.vm.view[1]===h.vm.view[1]){l=!0;break}}l||k||!q||m.isVal(q[h.key])||(k=[d,1])}}else if(!(a.type!==h.type||a.type!==m.TYPE_TEXT&&(null===a.tag||a.tag!==h.tag)||null!==h.key&&q&&m.isVal(q[h.key])))return[d,1];return k}function t(a,e){e.el=a.el;a.el=null;if(e.type===m.TYPE_TEXT&&e.body!==a.body)e.el.nodeValue=e.body;else{J(e,a);var b=!m.isArr(e.body),d=!m.isArr(a.body);b&&e.body!==a.body?d&&
e.el.firstChild?e.el.firstChild.nodeValue=e.body:e.raw?e.el.innerHTML=e.body:e.el.textContent=e.body:d&&!b&&(e.el.textContent="");a.moved=!0}}function y(a,e,b,d,c,g){if(a){var k=a["will"+e];m.isArr(k)&&(k=k[0]);var h=a["did"+e];m.isArr(h)&&(h=h[0]);a=function(){b.apply(null,d);h&&h.apply(null,g||c||d)};k?(k=k.apply(null,c||d),m.isProm(k)?k.then(a):a()):a()}else b.apply(null,d)}function L(a){if(a in H)return H[a];var e={tag:null,id:null,"class":null};e.tag=a.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,
function(a,b,c,d){c&&(e.id=c);d&&(e["class"]=d.replace(/\./g," ").trim());return b||"div"});return H[a]=e}function E(a,e,b,d){return function(c){var g;if(m.isFunc(a))g=a.call(e,c,b,d);else if(m.isObj(a))for(var k in a)c.target.matches(k)&&(g=a[k].call(e,c,b,d));!1===g&&(c.preventDefault(),c.stopPropagation());d.opts.hasOwnProperty("watch")&&d.opts.watch.fire({vm:d})}}function J(a,e){var b=!e;e=e||{};if(e.props||a.props){var d=e.props||{},c=a.props||{},g=d.style,k=c.style;if(m.isObj(g)||m.isObj(k))z(a.el,
g||{},k||{},I,B,a.ns,b),d.style=c.style=null;z(a.el,d,c,N,K,a.ns,b);k&&(c.style=k)}}function z(a,e,b,d,c,g,k){for(var h in b)null!==b[h]&&(h in e&&b[h]===e[h]||d(a,h,b[h],g,k));for(h in e)null!==e[h]&&(h in b||c(a,h,g,k))}function I(a,e,b){a.style[e]=m.autoPx(e,b)}function B(a,b){a.style[b]=""}function N(a,b,d,g,c){"."===b[0]?(b=b.substr(1),"svg"===g?a[b].baseVal=d:a[b]=d):"class"===b?a.className=d:"id"===b||m.isEvProp(b)?a[b]=d:!1===d?K(a,b,g,c):(!0===d&&(d=""),a.setAttribute(b,d))}function K(a,
b,d,g){g||("."===b[0]?(b=b.substr(1),"svg"===d?a[b].baseVal=null:a[b]=null):"class"===b?a.className="":"id"===b||m.isEvProp(b)?a[b]=null:a.removeAttribute(b))}var M={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},H={},G="undefined"==typeof document?{}:document,D={useRaf:!0,viewScan:!1,useDOM:!1};v.view=p;v.view.config=function(a){D=a};var C=null;v.view.extend=function(a,b){C=!C||b?[]:C;C.push(a)};var m=v.util;return v})(domvm);(function(v){var w=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,p=v.util;v.html=function(r){var b="";switch(r.type){case p.TYPE_ELEM:b+="<"+r.tag;if(r.props){var f=p.isVal(r.props.style)?r.props.style:"",l=p.isObj(r.props.style)?r.props.style:null;if(l)for(var d in l)null!==l[d]&&(f+=p.camelDash(d)+": "+p.autoPx(d,l[d])+"; ");for(d in r.props)p.isEvProp(d)||(l=r.props[d],p.isFunc(l)&&(l=l()),p.isObj(l)||(!0===l?b+=" "+d:!1!==l&&null!==l&&"."!==d[0]&&
(b+=" "+d+'="'+l+'"')));f.length&&(b+=' style="'+f.trim()+'"')}if(r.ns&&"svg"!==r.tag&&"math"!==r.tag&&!r.body)return b+"/>";b+=">";break;case p.TYPE_TEXT:return r.body}w.test(r.tag)||(p.isArr(r.body)?r.body.forEach(function(d){b+=v.html(d)}):b+=r.body||"",b+="</"+r.tag+">");return b}})(domvm);(function(v){var w=v.util;v.watch=function(p){function r(){}function b(b,g,q,f,t){t=t||{};t.method=(t.method||b).toUpperCase();if(null!==q){var y=Object.prototype.toString.call(q);"[object Array]"===y||"[object Object]"===y?(t.headers=t.headers||new Headers,t.headers.set("Content-Type","application/json"),t.body=JSON.stringify(q)):t.body=""+q}var y=f,p=r;f instanceof Array&&(y=f[0],f[1]&&(p=f[1]));f=fetch(g,t).then(function(b){if(200<=b.status&&300>b.status)return b;var d=Error(b.status+": "+b.statusText);
d.data=b;return Promise.reject(d)}).then(function(b){switch(b.headers.get("Content-Type").split("; ")[0]){case "application/json":return b.json();case "text/plain":return b.text();default:return b}}).then(y,p).then(function(b){!1!==b&&l.fire();return b},function(b){l.fire();return b});f._fetchArgs=[b,g,q,[y,p],t];return f}var f=[];w.isFunc(p)&&f.push(p);var l={on:function(b){f.push(b);return l},off:function(b){f.splice(f.indexOf(b),1);return l},fire:w.raft(function(){w.execAll(f,arguments);return l}),
prop:function(d,g){var f=d,p=function(b,d){arguments.length&&b!==f&&(f=b,!1!==d&&l.fire());return f};if(g&&g.then){p.update=r;if(g._fetchArgs){var t=g._fetchArgs[3];g._fetchArgs[3]=[function(b){return p(t[0]?t[0](b):b)},t[1]];p.update=function(){b.apply(null,g._fetchArgs)}}g.then(p)}return p.toString=p},sync:function(b,g,f){var l=b,t=g;"string"==typeof b&&(l=function(g){return"e."===b.substr(0,2)?g[b.substr(2)]:g.target[b]});return function(b){var d=this!==window?this:null;d&&"string"==typeof g&&
(t=function(b,f){var l=d[g];d[g]=b;p&&b!==l&&!1!==f&&p()});t(l(b),f)}},get:function(d,g,f){return b("get",d,null,g,f)},"delete":function(d,g,f){return b("delete",d,null,g,f)},post:function(d,g,f,l){return b("post",d,g,f,l)},put:function(d,g,f,l){return b("put",d,g,f,l)},patch:function(d,g,f,l){return b("patch",d,g,f,l)}};return l}})(domvm);(function(v){function w(b,f,l){if("/"===f[0]){var d=f;f=null;var g,q;for(q in b)if(g=d.match(b[q].regexPath)){l=g.slice(1);f=q;break}null===f&&(f="_noMatch")}else d=p(b,f,l);return{name:f,route:b[f],params:l,path:d}}function p(b,f,l){var d=b[f];b=d.path;if(l&&-1!==b.indexOf(":")){l=l.slice();var g=!0;b=b.replace(/:([^\/]+)/g,function(b,f){var t=l.shift();if(d.params&&d.params[f]){if((""+t).match(d.params[f]))return t;g=!1}else return t});return g?b:g}return b}function r(b){for(var f in b){var l=b[f];
l.regexPath=new RegExp("^"+l.path.replace(/:([^\/]+)/g,function(b,f){var q=""+l.params[f];return"("+q.substring(1,q.lastIndexOf("/"))+")"})+"$")}}v.route=function(b,f){var l={href:function(b,d,f){var g=function(g){l["goto"](b,d,f);g.preventDefault()};g.path=p(v,b,d);return g},refresh:function(){l["goto"](window.location.pathname)},"goto":function(b,f,l){f=f||[];l=l||d;var p=w(v,b,f),r=p.path;b=p.name;f=p.params;if(!1===r)console.log("Could not find route");else{for(var p=null,z=0;z<q.length;z++)if(q[z].path===
r){p=z;break}null===p&&(q.splice(g+1,1E4),q.push({name:b,route:v[b],params:f,path:r}),p=q.length-1);var z=q[g],I=q[p];Array.prototype.slice.call(arguments);var B=!0;null!==g&&(B=(B=q[g].route.onexit)?B.apply(null,[{to:I}].concat(z?z.params:[])):!0);!1!==B&&!1!==q[p].route.onenter.apply(null,[{from:z}].concat(f))&&(history[l?"replaceState":"pushState"]([b,f],"title",r),g=p);d=!1}},current:function(){return d?w(v,window.location.pathname):q[g]}},d=!0,g=null,q=[],v=b(l,f);r(v);window.onpopstate=function(b){l["goto"].apply(null,
b.state.concat(!0))};return l}})(domvm);
