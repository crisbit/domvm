/*
 https://github.com/leeoniya/domvm
*/
("undefined"!==typeof global?global:this).domvm={};(function(u){var w="undefined"==typeof window?{}:window,t={TYPE_ELEM:1,TYPE_TEXT:2,isArr:function(b){return b instanceof Array},isVal:function(b){b=typeof b;return"string"===b||"number"===b},isObj:function(b){return"object"===typeof b&&null!==b&&!t.isArr(b)},isFunc:function(b){return"function"===typeof b},isProm:function(b){return"object"===typeof b&&t.isFunc(b.then)},execAll:function(b,m){b&&(t.isArr(b)?b:[b]).forEach(function(b){return b.apply(null,m)})},insertArr:function(b,m,q,l){b.splice.apply(b,
[q,l].concat(m))},isEvProp:function(b){return"on"===b.substr(0,2)},camelDash:function(b){return b.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},raft:function(b){function m(){q=0;b.apply(l,f)}if(!w.requestAnimationFrame)return b;var q,l,f;return function(){l=this;f=arguments;q||(q=w.requestAnimationFrame(m))}}};u.util=t})(domvm);(function(u){function w(a,d,x,g,c,y,A){function h(a,c,d){if(d)a[c]=a[c]||[],a[c].push(d);else for(var g in c)a[g]=a[g]||[],a[g].push(c[g])}function e(a,c,d){y=a;A=c;return m(d,!1)}function m(a,c){p.hooks&&k.execAll(p.hooks.willRedraw);p.imp=null!=a?a:g;p.refs={};var h=p.node,e=p.render.call(p.exp,p,d,x,p.imp),e=q(e,y,A,p);e.key=k.isVal(x)?x:e.key;e.vm=p;p.node=e;for(var n="!"===(""+e.key)[0]?e.key.substr(1):null,r=y;r;)r.vm&&(p.parent||(p.parent=r.vm),null!==n&&(r.vm.keys[n]=p)),r=r.parent;if((n=
h)&&(e.type!==h.type||e.tag!==h.tag))var n=null,v=!0;l(e,n);y&&(y.body[A]=e);!1!==c&&(h&&b(h),!h&&z||f(e,null,e.el),v&&(h.el.parentNode.replaceChild(e.el,h.el),h.el=null));Promise.resolve().then(function(){var a=p,c;for(c in a.refs)a.refs[c]=a.refs[c].el;p.hooks&&k.execAll(p.hooks.didRedraw)});return p}function n(a){p.hooks&&k.execAll(p.hooks.willUnmount);if(y)if(a){for(a=A+1;a<y.body.length;a++){var c=y.body[a];c.idx=a-1;c.vm&&c.vm.updIdx(c.idx)}y.body.splice(A,1)}else y.body[A]=null;b(p.node,!0);
p.node.vm=null;p.hooks&&k.execAll(p.hooks.didUnmount)}function r(a){var c=null,d=a.split(":");2==d.length&&(a=d[0],c=+d[1]);var d=Array.prototype.slice.call(arguments,1),g=p;if(null!==c)for(;c--&&g.parent;)g=g.parent;else for(;g&&!g.events[a];)g=g.parent;k.execAll(g.events[a],d)}var z=!y;k.isArr(a)&&(d=a[1],x=a[2],g=a[3],c=a[4],a=a[0]);!1===x&&(g=d,x=d=null);var p={exp:{},imp:g||{},node:null,view:[a,d,x],opts:c||{},render:null,on:function(a,c){h(p.events,a,c)},hook:function(a,c){p.hooks=p.hooks||
{};h(p.hooks,a,c)},events:{},hooks:null,redraw:C.useRaf?k.raft(m):m,patch:function(a,c){var d=a.parent,g=l(q(c,d,a.idx,p),a);d.body[a.idx]=g;g=g.key;k.isVal(g)&&(d.keyMap[g]=a.idx)},emit:r,refs:{},parent:null,keys:{},mount:function(a,c){p.hooks&&k.execAll(p.hooks.willMount);c&&(a.textContent="");f(p.node,c?a:null);c||a.insertBefore(p.node.el,null);p.hooks&&k.execAll(p.hooks.didMount);return p},attach:function(a){t(p.node,a);return p},unmount:function(){v(p.hooks,"Unmount",n,[])},moveTo:e,updIdx:function(a){A=
a}};p.events._redraw=p.redraw;p.render=a.call(p.exp,p,d,x,g);r.redraw=function(a){a=k.isVal(a)?a:1E3;r("_redraw:"+a)};return y?e(y,A,g):m(g)}function t(a,d){a.el=d;if(k.isArr(a.body))for(var x=0;x<a.body.length;x++)t(a.body[x],d.childNodes[x])}function b(a,d){k.isArr(a.body)&&(a.body.forEach(function(a,d){a&&(a.vm&&!a.moved?a.vm.unmount():b(a,!0))}),a.body=null);a.vm=null;d&&a.el&&a.el.parentNode&&v(a.hooks,"Remove",m,[a])}function m(a){a.el.parentNode.removeChild(a.el);a.el=null}function q(a,d,x,
g){var c=a;a={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,hooks:null,tag:null,ns:null,guard:!1,raw:!1,props:null,el:null,keyMap:null,body:null};k.isFunc(c)&&(c=c());if(k.isArr(c)&&c.length){a.type=k.TYPE_ELEM;if(1<c.length){var b=1;k.isObj(c[1])&&(a.props=c[1],b=2);a.body=c.length==b+1?k.isVal(c[b])?c[b]:k.isFunc(c[b])?c[b]():c.slice(b):c.slice(b)}c=c[0];if(/[.#]/.test(c)){if(c=z(c),a.tag=c.tag,c.id||c["class"])a.props=a.props||{},a.props.id=c.id,a.props["class"]=c["class"]}else a.tag=
c;if(a.props){var c=a.props,e;for(e in c)k.isEvProp(e)?c[e]=H(c[e],g.opts.evctx||g.view[1]||g.imp||null,a,g):k.isFunc(c[e])&&("href"==e?(c.onclick=c[e],c.href=c[e].url):c[e]=c[e]());if(k.isObj(c.style))for(var h in c.style)e=c.style[h],k.isFunc(e)&&(c.style[h]=e());k.isObj(c._hooks)&&(a.hooks=c._hooks,c._hooks=null);a.key=k.isVal(c._key)?c._key:k.isVal(c._ref)?c._ref:k.isVal(c.id)?c.id:k.isVal(c.name)?c.name:null;c._ref&&(a.ref=c._ref);c._raw&&(a.raw=!0);c._guard&&(a.guard=!0);c._ref=c._key=c._raw=
c._guard=null}}else k.isVal(c)&&(a.type=k.TYPE_TEXT,a.body=c);null!==a.ref&&(g.refs[a.ref]=a);a.parent=d;a.idx=x;a.ns=d&&d.ns?d.ns:"svg"===a.tag||"math"===a.tag?a.tag:null;if(k.isArr(a.body)){d={};x=!1;h=0;for(e=a.body.length;h<e;h++){var c=a.body[h],f=b=null,n=!1,r=!1;k.isFunc(c)&&(c=c());if(null==c)n=!0;else{var m=k.isArr(c),l=m?!1:k.isObj(c);if(m)c.length?k.isArr(c[0])?r=!0:k.isFunc(c[0])?b=c[2]:(f=q(c,a,h,g),b=f.key):n=!0;else if(l)if(k.isFunc(c.redraw))c.moveTo(a,h),f=c.node,b=c.view[2];else{a.body[h--]=
""+c;continue}else""===c?n=!0:0<h&&a.body[h-1].type===k.TYPE_TEXT?(a.body[h-1].body+=""+c,n=!0):f=q(""+c,a,h,g)}n||r?(r?k.insertArr(a.body,c,h,1):a.body.splice(h,1),e=a.body.length,h--):(k.isVal(b)&&(d[b]=h,x=!0),a.body[h]=f||c)}x&&(a.keyMap=d)}return a}function l(a,d){d&&v(a.hooks,"Recycle",e,[d,a]);if(k.isArr(a.body)){var b=0;a.body.forEach(function(g,c){var e=k.isArr(g);if(d){var f=n(g,a,d,b);if(null!==f){var h=f[0],f=f[1];h===b&&b++;h=d.body[h];e&&h.vm?2===f?h.vm.moveTo(a,c,g[3]):1===f&&w(g[0],
g[1],g[2],g[3],g[4],a,c):a.body[c]=l(g,h);return}}e?w(g[0],g[1],g[2],g[3],g[4],a,c):a.body[c]=l(g)})}return a}function f(a,d,b){var g=!a.el;if(a.type==k.TYPE_ELEM)if(g&&(a.el=d&&d.nodeName?d:a.ns?D.createElementNS(I[a.ns],a.tag):D.createElement(a.tag),a.props&&F(a)),k.isArr(a.body)){d=0;for(var c=a.el.firstChild;d<a.body.length;d++)c=f(a.body[d],null,c)?c:c.nextSibling||null}else g&&k.isVal(a.body)&&(a.raw?a.el.innerHTML=a.body:a.el.textContent=a.body);else a.type==k.TYPE_TEXT&&g&&(a.el=D.createTextNode(a.body));
a.el._node=a;if(b===a.el)return!1;if((d=a.parent)&&d.el)return v(a.hooks,g?"Insert":"Reinsert",r,[a,b]),!0}function r(a,d){a.parent.el.insertBefore(a.el,d)}function n(a,d,b,g,c){var e=k.isArr(a),f=e?a[2]||null:a.key,h=b.keyMap,n=d.keyMap;b=b.body;d=d.body;if(null!==f&&h&&k.isVal(h[f]))return[h[f],2];g=g||0;if(g>b.length-1)return null;c=0===c?0:c||b.length-1;for(f=null;g<=c;g++)if(h=b[g],null!==h&&h.el)if(e&&h.vm){if(h.vm.view[0]===a[0]){if(h.vm.view[1]===a[1])return[g,2];var r=!1;if(C.viewScan)for(var m=
0;m<d.length;m++){var l=d[m];if(!l.el&&l.vm&&l.vm.view[0]===h.vm.view[0]&&l.vm.view[1]===h.vm.view[1]){r=!0;break}}r||f||!n||k.isVal(n[h.key])||(f=[g,1])}}else if(!(a.type!==h.type||a.type!==k.TYPE_TEXT&&(null===a.tag||a.tag!==h.tag)||null!==h.key&&n&&k.isVal(n[h.key])))return[g,1];return f}function e(a,d){d.el=a.el;a.el=null;if(d.type===k.TYPE_TEXT&&d.body!==a.body)d.el.nodeValue=d.body;else{F(d,a);var b=!k.isArr(d.body),g=!k.isArr(a.body);b&&d.body!==a.body?g&&d.el.firstChild?d.el.firstChild.nodeValue=
d.body:d.raw?d.el.innerHTML=d.body:d.el.textContent=d.body:g&&!b&&(d.el.textContent="");a.moved=!0}}function v(a,d,b,g,c,e){if(a){var f=a["will"+d];k.isArr(f)&&(f=f[0]);var h=a["did"+d];k.isArr(h)&&(h=h[0]);a=function(){b.apply(null,g);h&&h.apply(null,e||c||g)};f?(f=f.apply(null,c||g),k.isProm(f)?f.then(a):a()):a()}else b.apply(null,g)}function z(a){if(a in E)return E[a];var d={tag:null,id:null,"class":null};d.tag=a.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,function(a,b,c,e){c&&(d.id=
c);e&&(d["class"]=e.replace(/\./g," ").trim());return b||"div"});return E[a]=d}function H(a,d,b,g){return function(c){var e;if(k.isFunc(a))e=a.call(d,c,b,g);else if(k.isObj(a))for(var f in a)c.target.matches(f)&&(e=a[f].call(d,c,b,g));!1===e&&(c.preventDefault(),c.stopPropagation());g.opts.hasOwnProperty("watch")&&g.opts.watch.fire({vm:g})}}function F(a,d){var b=!d;d=d||{};if(d.props||a.props){var e=d.props||{},c=a.props||{},f=e.style,n=c.style;if(k.isObj(f)||k.isObj(n))B(a.el,f||{},n||{},J,K,a.ns,
b),e.style=c.style=null;B(a.el,e,c,L,G,a.ns,b);n&&(c.style=n)}}function B(a,d,b,e,c,f,k){for(var h in b)null!==b[h]&&(h in d&&b[h]===d[h]||e(a,h,b[h],f,k));for(h in d)null!==d[h]&&(h in b||c(a,h,f,k))}function J(a,d,b){a.style[d]=isNaN(b)||M[d]?b:b+"px"}function K(a,d){a.style[d]=""}function L(a,d,b,e,c){"."===d[0]?(d=d.substr(1),"svg"===e?a[d].baseVal=b:a[d]=b):"class"===d?a.className=b:"id"===d||k.isEvProp(d)?a[d]=b:!1===b?G(a,d,e,c):(!0===b&&(b=""),a.setAttribute(d,b))}function G(a,d,b,e){e||("."===
d[0]?(d=d.substr(1),"svg"===b?a[d].baseVal=null:a[d]=null):"class"===d?a.className="":"id"===d||k.isEvProp(d)?a[d]=null:a.removeAttribute(d))}var I={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},E={},D="undefined"==typeof document?{}:document,M={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,
opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},C={useRaf:!0,viewScan:!1,useDOM:!1};u.view=w;u.config=function(a){C=a};var k=u.util;return u})(domvm);(function(u){var w=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,t=u.util;u.html=function(b){var m="";switch(b.type){case t.TYPE_ELEM:m+="<"+b.tag;if(b.props){var q=t.isVal(b.props.style)?b.props.style:"",l=t.isObj(b.props.style)?b.props.style:null;if(l)for(var f in l)null!==l[f]&&(q+=t.camelDash(f)+": "+l[f]+";");for(f in b.props)t.isEvProp(f)||(l=b.props[f],t.isFunc(l)&&(l=l()),t.isObj(l)||(!0===l?m+=" "+f:!1!==l&&null!==l&&"."!==f[0]&&(m+=" "+f+'="'+
l+'"')));q.length&&(m+=' style="'+q+'"')}if(b.ns&&"svg"!==b.tag&&"math"!==b.tag&&!b.body)return m+"/>";m+=">";break;case t.TYPE_TEXT:return b.body}w.test(b.tag)||(t.isArr(b.body)?b.body.forEach(function(b){m+=u.html(b)}):m+=b.body||"",m+="</"+b.tag+">");return m}})(domvm);(function(u){var w=u.util;u.watch=function(t){function b(){}function m(f,m,n,e,v){v=v||{};v.method=(v.method||f).toUpperCase();if(null!==n){var z=Object.prototype.toString.call(n);"[object Array]"===z||"[object Object]"===z?(v.headers=v.headers||new Headers,v.headers.set("Content-Type","application/json"),v.body=JSON.stringify(n)):v.body=""+n}var z=e,q=b;e instanceof Array&&(z=e[0],e[1]&&(q=e[1]));e=fetch(m,v).then(function(b){if(200<=b.status&&300>b.status)return b;var e=Error(b.statusText);e.resp=
b;throw e;}).then(function(b){switch(b.headers.get("Content-Type").split("; ")[0]){case "application/json":return b.json();case "text/plain":return b.text();default:return b}}).then(z,q).then(function(b){!1!==b&&l.fire();return b},b);e._fetchArgs=[f,m,n,[z,q],v];return e}var q=[];w.isFunc(t)&&q.push(t);var l={on:function(b){q.push(b);return l},off:function(b){q.splice(q.indexOf(b),1);return l},fire:function(){w.execAll(q,arguments);return l},prop:function(f,r){var n=f,e=function(b,e){arguments.length&&
b!==n&&(n=b,!1!==e&&l.fire());return n};if(r&&r.then){e.update=b;if(r._fetchArgs){var v=r._fetchArgs[3];r._fetchArgs[3]=[function(b){return e(v[0]?v[0](b):b)},v[1]];e.update=function(){m.apply(null,r._fetchArgs)}}r.then(e)}return e.toString=e},sync:function(b,m,n){var e=b,l=m;"string"==typeof b&&(e=function(e){return"e."===b.substr(0,2)?e[b.substr(2)]:e.target[b]});return function(b){var f=this!==window?this:null;f&&"string"==typeof m&&(l=function(b,e){var n=f[m];f[m]=b;t&&b!==n&&!1!==e&&t()});l(e(b),
n)}},get:function(b,l,n){return m("get",b,null,l,n)},"delete":function(b,l,n){return m("delete",b,null,l,n)},post:function(b,l,n,e){return m("post",b,l,n,e)},put:function(b,l,n,e){return m("put",b,l,n,e)},patch:function(b,l,n,e){return m("patch",b,l,n,e)}};return l}})(domvm);(function(u){u.route=function(u,t){function b(b,e){var f=r[b],l=f.url;if(e&&-1!==l.indexOf(":")){e=e.slice();var m=!0,l=l.replace(/:([^\/]+)/g,function(b,l){var n=e.shift();if(f.params&&f.params[l]){if((""+n).match(f.params[l]))return n;m=!1}else return n});return m?l:m}return l}var m=!0,q={href:function(){var f=arguments,e=function(b){q["goto"].apply(null,f);b.preventDefault()};e.url=b.apply(null,f);return e},"goto":function(n,e,q){e=e||[];q=q||m;var t=b(n,e);if(!1===t)console.log("Could not find route");
else{for(var u=null,w=0;w<f.length;w++)if(f[w].url===t){u=w;break}null===u&&(f.splice(l+1,1E4),f.push({name:n,route:r[n],params:e,url:t}),u=f.length-1);w=f[u];Array.prototype.slice.call(arguments);var B=!0;null!==l&&(B=f[l].route.onexit.call(null,f[u].params.concat(w)));!1!==B&&!1!==f[u].route.onenter.apply(null,e.concat(f[l]))&&(history[q?"replaceState":"pushState"]([n,e],"title",t),l=u);m=!1}},current:function(){return f[l]}},l=null,f=[],r=u(q,t);window.onpopstate=function(b){q["goto"].apply(null,
b.state.concat(!0))};return q}})(domvm);
