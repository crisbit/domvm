// https://github.com/leeoniya/domvm
("object"===typeof module&&"object"===typeof module.exports&&function(q){module.exports=q()}||"function"===typeof define&&function(q){define("domvm",q)}||function(q){window.domvm=q()})(function(){return{}});(function(q){var u={TYPE_ELEM:1,TYPE_TEXT:2,isArr:function(d){return d instanceof Array},isVal:function(d){d=typeof d;return"string"===d||"number"===d},isObj:function(d){return"object"===typeof d&&null!==d&&!u.isArr(d)},isFunc:function(d){return"function"===typeof d},execAll:function(d,g){d.forEach(function(h){return h.apply(null,g)})},insertArr:function(d,g,h,n){d.splice.apply(d,[h,n].concat(g))},isEvProp:function(d){return"on"===d.substr(0,2)},camelDash:function(d){return d.replace(/([a-z])([A-Z])/g,
"$1-$2").toLowerCase()},raft:function(d){function g(){h=0;d.apply(n,b)}if(!win.requestAnimationFrame)return d;var h,n,b;return function(){n=this;b=arguments;h||(h=win.requestAnimationFrame(g))}}};domvm.util=u})(domvm);(function(q){function u(a,e,k,z,c,t,y){function l(a,e,c){t=a;y=e;return f(c,!1)}function f(a,c){m.execAll(p.events.willRedraw);p.imp=null!=a?a:z;p.refs={};var l=p.node,d=p.render.call(e,p.imp),d=h(d,t,y,p);d.key=m.isVal(k)?k:d.key;d.vm=p;p.node=d;var v=l;if(l&&(d.type!==l.type||d.tag!==l.tag))var v=null,q=!0;n(d,v);t&&(t.body[y]=d);!1!==c&&(l&&g(l),!l&&r||b(d),q&&(l.el.parentNode.replaceChild(d.el,l.el),l.el=null));setTimeout(function(){var a=p,c;for(c in a.refs)a.refs[c]=a.refs[c].el;m.execAll(p.events.didRedraw)},
0);return p}function v(a){var c=null,e=a.split(":");2==e.length&&(a=e[0],c=+e[1]);var e=Array.prototype.slice.call(arguments,1),k=p.node;if(null!==c){for(;c&&k.parent;)k=k.parent,k.vm&&c--;(c=(c=k.vm?k.vm.events:null)?c[a]:null)&&c.apply(null,e)}else for(;k&&(!k.vm||!(c=(c=k.vm.events)?c[a]:null)||!1!==c.apply(null,e));)k=k.parent}var r=!t;m.isArr(a)&&(e=a[1],k=a[2],z=a[3],a=a[0]);!1===k&&(z=e,k=e=null);var p={exp:{},imp:z||{},node:null,view:[a,e,k],render:null,on:function(a,c){if(c)p.events[a].push(c);
else for(var e in a)p.events[e].push(a[e])},events:{willRedraw:[],didRedraw:[],willDestroy:[],didDestroy:[]},redraw:A.useRaf?raft(f):f,patch:function(a,c){var e=a.parent,k=n(h(c,e,a.idx,p),a);e.body[a.idx]=k;var l=k.key;m.isVal(l)&&(e.keyMap[l]=k)},emit:v,refs:{},mount:function(a){b(p.node);a.insertBefore(p.node.el,null);return p},attach:function(a){d(p.node,a);return p},destroy:function(a){m.execAll(p.events.willDestroy);if(t)if(a){for(a=y+1;a<t.body.length;a++){var c=t.body[a];c.idx=a-1;c.vm&&c.vm.updIdx(c.idx)}t.body.splice(y,
1)}else t.body[y]=null;g(p.node,!0);p.node.vm=null;m.execAll(p.events.didDestroy)},moveTo:l,updIdx:function(a){y=a}};p.events._redraw=p.redraw;p.render=a.call(p.exp,p,e,k,z);v.redraw=function(a){a=m.isVal(a)?a:1E3;v("_redraw:"+a)};return t?l(t,y,z):f(z)}function d(a,e){a.el=e;if(m.isArr(a.body))for(var k=0;k<a.body.length;k++)d(a.body[k],e.childNodes[k])}function g(a,e){m.isArr(a.body)&&(a.body.forEach(function(a,e){a&&(a.vm&&!a.moved?a.vm.destroy():a.el&&a.el.parentNode?a.el.parentNode.removeChild(a.el):
g(a))}),a.body=null);a.vm=null;e&&a.el&&(a.el.parentNode.removeChild(a.el),a.el=null)}function h(a,e,k,d){var c=a;a={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,tag:null,ns:null,guard:!1,raw:!1,props:null,el:null,keyMap:null,body:null};m.isFunc(c)&&(c=c());if(m.isArr(c)&&c.length){a.type=m.TYPE_ELEM;if(1<c.length){var b=1;m.isObj(c[1])&&(a.props=c[1],b=2);a.body=c.length==b+1?m.isVal(c[b])?c[b]:m.isFunc(c[b])?c[b]():c.slice(b):c.slice(b)}c=c[0];if(/[.#]/.test(c)){if(c=v(c),a.tag=c.tag,
c.id||c["class"])a.props=a.props||{},a.props.id=c.id,a.props["class"]=c["class"]}else a.tag=c;if(a.props){var c=a.props,f;for(f in c)m.isEvProp(f)?c[f]=B(c[f],d.view[1]||null):m.isFunc(c[f])&&("href"==f?(c.onclick=c[f],c.href=c[f].url):c[f]=c[f]());if(m.isObj(c.style))for(var l in c.style)f=c.style[l],m.isFunc(f)&&(c.style[l]=f());a.key=m.isVal(c._key)?c._key:m.isVal(c._ref)?c._ref:m.isVal(c.id)?c.id:m.isVal(c.name)?c.name:null;c._ref&&(a.ref=c._ref);c._raw&&(a.raw=!0);c._guard&&(a.guard=!0);c._ref=
c._key=c._raw=c._guard=null}}else m.isVal(c)&&(a.type=m.TYPE_TEXT,a.body=c);null!==a.ref&&(d.refs[a.ref]=a);a.parent=e;a.idx=k;a.ns=e&&e.ns?e.ns:"svg"===a.tag||"math"===a.tag?a.tag:null;if(m.isArr(a.body)){e={};k=!1;l=0;for(f=a.body.length;l<f;l++){var c=a.body[l],n=b=null,g=!1,r=!1;m.isFunc(c)&&(c=c());if(null==c)g=!0;else{var p=m.isArr(c),q=p?!1:m.isObj(c);if(p)c.length?m.isArr(c[0])?r=!0:m.isFunc(c[0])?b=c[2]:(n=h(c,a,l,d),b=n.key):g=!0;else if(q)if(m.isFunc(c.redraw))c.moveTo(a,l),n=c.node,b=
c.view[2];else{a.body[l--]=""+c;continue}else""===c?g=!0:0<l&&a.body[l-1].type===m.TYPE_TEXT?(a.body[l-1].body+=""+c,g=!0):n=h(""+c,a,l,d)}g||r?(r?m.insertArr(a.body,c,l,1):a.body.splice(l,1),f=a.body.length,l--):(m.isVal(b)&&(e[b]=l,k=!0),a.body[l]=n||c)}k&&(a.keyMap=e)}return a}function n(a,e){e&&r(e,a);m.isArr(a.body)&&a.body.forEach(function(k,b){var c=m.isArr(k);if(e){var d=f(k,a,e);if(null!==d){var h=d[1],d=e.body[d[0]];c&&d.vm?2===h?d.vm.moveTo(a,b,k[3]):1===h&&u(k[0],k[1],k[2],k[3],k[4],a,
b):a.body[b]=n(k,d);return}}c?u(k[0],k[1],k[2],k[3],k[4],a,b):a.body[b]=n(k)});return a}function b(a){var e=!a.el;a.type==m.TYPE_ELEM?(e&&(a.el=a.ns?C.createElementNS(G[a.ns],a.tag):C.createElement(a.tag),a.props&&E(a)),m.isArr(a.body)?a.body.forEach(b):e&&m.isVal(a.body)&&(a.raw?a.el.innerHTML=a.body:a.el.textContent=a.body)):a.type==m.TYPE_TEXT&&e&&(a.el=C.createTextNode(a.body));a.el._node=a;(e=a.parent)&&e.el&&e.el.childNodes[a.idx]!==a.el&&e.el.insertBefore(a.el,e.el.childNodes[a.idx])}function f(a,
e,k,b,c){var d=m.isArr(a),h=d?a[2]||null:a.key,l=k.keyMap,f=e.keyMap;k=k.body;e=e.body;if(null!==h&&l&&m.isVal(l[h]))return[l[h],2];b=b||0;if(b>k.length-1)return null;c=0===c?0:c||k.length-1;for(h=null;b<=c;b++)if(l=k[b],null!==l&&l.el)if(d&&l.vm){if(l.vm.view[0]===a[0]){if(l.vm.view[1]===a[1])return[b,2];var n=!1;if(A.viewScan)for(var g=0;g<e.length;g++){var p=e[g];if(!p.el&&p.vm&&p.vm.view[0]===l.vm.view[0]&&p.vm.view[1]===l.vm.view[1]){n=!0;break}}n||h||!f||m.isVal(f[l.key])||(h=[b,1])}}else if(!(a.type!==
l.type||a.type!==m.TYPE_TEXT&&(null===a.tag||a.tag!==l.tag)||null!==l.key&&f&&m.isVal(f[l.key])))return[b,1];return h}function r(a,e){e.el=a.el;a.el=null;if(e.type===m.TYPE_TEXT&&e.body!==a.body)e.el.nodeValue=e.body;else{E(e,a);var k=!m.isArr(e.body),b=!m.isArr(a.body);k&&e.body!==a.body?b&&e.el.firstChild?e.el.firstChild.nodeValue=e.body:e.raw?e.el.innerHTML=e.body:e.el.textContent=e.body:b&&!k&&(e.el.textContent="");a.moved=!0}}function v(a){if(a in D)return D[a];var e={tag:null,id:null,"class":null};
e.tag=a.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,function(a,b,c,d){c&&(e.id=c);d&&(e["class"]=d.replace(/\./g," ").trim());return b||"div"});return D[a]=e}function B(a,e){return function(k){var b;if(m.isFunc(a))b=a.call(e,k);else if(m.isObj(a))for(var c in a)k.target.matches(c)&&(b=a[c].call(e,k));!1===b&&(k.preventDefault(),k.stopPropagation())}}function E(a,e){var b=!e;e=e||{};if(e.props||a.props){var d=e.props||{},c=a.props||{},h=d.style,f=c.style;if(m.isObj(h)||m.isObj(f))F(a.el,
h||{},f||{},H,I,a.ns,b),d.style=c.style=null;F(a.el,d,c,w,x,a.ns,b);f&&(c.style=f)}}function F(a,e,b,d,c,h,f){for(var l in b)null!==b[l]&&(l in e&&b[l]===e[l]||d(a,l,b[l],h,f));for(l in e)null!==e[l]&&(l in b||c(a,l,h,f))}function H(a,e,b){a.style[e]=isNaN(b)||J[e]?b:b+"px"}function I(a,e){a.style[e]=""}function w(a,e,b,d,c){"."===e[0]?(e=e.substr(1),"svg"===d?a[e].baseVal=b:a[e]=b):"class"===e?a.className=b:"id"===e||m.isEvProp(e)?a[e]=b:!1===b?x(a,e,d,c):(!0===b&&(b=""),a.setAttribute(e,b))}function x(a,
e,b,d){d||("."===e[0]?(e=e.substr(1),"svg"===b?a[e].baseVal=null:a[e]=null):"class"===e?a.className="":"id"===e||m.isEvProp(e)?a[e]=null:a.removeAttribute(e))}var G={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},D={},C="undefined"==typeof document?{}:document,J={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,
lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},A={useRaf:!0,viewScan:!1,useDOM:!1};q.view=u;q.config=function(a){A=a};var m=q.util;return q})(domvm);(function(q){var u=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,d=q.util;q.html=function(g){var h="";switch(g.type){case d.TYPE_ELEM:h+="<"+g.tag;if(g.props){var n=d.isVal(g.props.style)?g.props.style:"",b=d.isObj(g.props.style)?g.props.style:null;if(b)for(var f in b)null!==b[f]&&(n+=d.camelDash(f)+": "+b[f]+";");for(f in g.props)d.isEvProp(f)||(b=g.props[f],d.isFunc(b)&&(b=b()),d.isObj(b)||(!0===b?h+=" "+f:!1!==b&&null!==b&&"."!==f[0]&&(h+=" "+f+'="'+
b+'"')));n.length&&(h+=' style="'+n+'"')}if(g.ns&&"svg"!==g.tag&&"math"!==g.tag&&!g.body)return h+"/>";h+=">";break;case d.TYPE_TEXT:return g.body}u.test(g.tag)||(d.isArr(g.body)?g.body.forEach(function(b){h+=q.html(b)}):h+=g.body||"",h+="</"+g.tag+">");return h}})(domvm);(function(q){q.watch=function(q){function d(){}function g(h,n,b,f,g){g=g||{};g.method=(g.method||h).toUpperCase();null!==b&&(h=Object.prototype.toString.call(b),"[object Array]"===h||"[object Object]"===h?(g.headers=g.headers||new Headers,g.headers.set("Content-Type","application/json"),g.body=JSON.stringify(b)):g.body=""+b);b=f;h=d;f instanceof Array&&(b=f[0],f[1]&&(h=f[1]));return fetch(n,g).then(function(b){if(200<=b.status&&300>b.status)return b;var d=Error(b.statusText);d.resp=b;throw d;}).then(function(b){switch(b.headers.get("Content-Type").split("; ")[0]){case "application/json":return b.json();
case "text/plain":return b.text();default:return b}}).then(b,h).then(function(b){!1!==b&&q()},d)}return{prop:function(d){var g=d;return function(b,d){arguments.length&&b!==g&&(g=b,q&&!1!==d&&q());return g}},sync:function(d,g,b){var f=d,r=g;"string"==typeof d&&(f=function(b){return"e."===d.substr(0,2)?b[d.substr(2)]:b.target[d]});return function(d){var h=this!==window?this:null;h&&"string"==typeof g&&(r=function(b,d){var f=h[g];h[g]=b;q&&b!==f&&!1!==d&&q()});r(f(d),b)}},get:function(d,n,b){return g("get",
d,null,n,b)},"delete":function(d,n,b){return g("delete",d,null,n,b)},post:function(d,n,b,f){return g("post",d,n,b,f)},put:function(d,n,b,f){return g("put",d,n,b,f)},patch:function(d,n,b,f){return g("patch",d,n,b,f)}}}})(domvm);(function(q){q.route=function(q,d){function g(b,d){var f=v[b],g=B+f.url;if(d&&-1!==g.indexOf(":")){d=d.slice();var h=!0,g=g.replace(/:([^\/]+)/g,function(b,g){var n=d.shift();if(f.params&&f.params[g]){if((""+n).match(f.params[g]))return n;h=!1}else return n});return h?g:h}return g}var h=!0,n={href:function(){var b=arguments,d=function(d){n["goto"].apply(null,b);d.preventDefault()};d.url=g.apply(null,b);return d},"goto":function(d,n,q){n=n||[];q=q||h;var r=g(d,n);if(!1===r)console.log("Could not find route");
else{for(var w=null,x=0;x<f.length;x++)if(f[x].url===r){w=x;break}null===w&&(f.splice(b+1,1E4),f.push({name:d,route:v[d],params:n,url:r}),w=f.length-1);x=f[w];Array.prototype.slice.call(arguments);var u=!0;null!==b&&(u=f[b].route.onexit.call(null,f[w].params.concat(x)));!1!==u&&!1!==f[w].route.onenter.apply(null,n.concat(f[b]))&&(history[q?"replaceState":"pushState"]([d,n],"title",r),b=w);h=!1}},current:function(){return f[b]}},b=null,f=[],r=q(n,d),v=r.routes,B=r.root||"/";window.onpopstate=function(b){n["goto"].apply(null,
b.state.concat(!0))};return n}})(domvm);
