/*
 https://github.com/leeoniya/domvm
*/
("undefined"!==typeof global?global:this).domvm={};(function(u){var B="undefined"==typeof window?{}:window,t={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},e={TYPE_ELEM:1,TYPE_TEXT:2,isArr:function(a){return a instanceof
Array},isVal:function(a){a=typeof a;return"string"===a||"number"===a},isObj:function(a){return"object"===typeof a&&null!==a&&!e.isArr(a)},isFunc:function(a){return"function"===typeof a},isProm:function(a){return"object"===typeof a&&e.isFunc(a.then)},execAll:function(a,y){a&&(e.isArr(a)?a:[a]).forEach(function(a){return a.apply(null,y)})},insertArr:function(a,e,m,f){a.splice.apply(a,[m,f].concat(e))},isEvProp:function(a){return"on"===a.substr(0,2)},isDynProp:function(a,e){switch(a){case "input":case "textarea":case "select":case "option":switch(e){case "value":case "checked":case "selected":case "selectedIndex":return!0}}},
camelDash:function(a){return a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},autoPx:function(a,e){return isNaN(e)||t[a]?e:e+"px"},indexOfKey:function(a,e,m,f){for(m=0;m<e.length;m++)if(e[m].key===a)return m;return-1},raft:function(a){function e(){m=0;a.apply(f,C)}if(!B.requestAnimationFrame)return a;var m,f,C;return function(){f=this;C=arguments;m||(m=B.requestAnimationFrame(e))}}};u.util=e})(domvm);(function(u){function B(b,c){return!1===c?null:null==c&&null!=b?b:h.isVal(c)||h.isObj(c)||h.isArr(c)||h.isFunc(c)?c:null}function t(b,c,v,n,d,g){function l(b,c,d){if(d)b[c]=b[c]||[],b[c].push(d);else for(var g in c)b[g]=b[g]||[],b[g].push(c[g])}function k(b,c,v){d=b;g=c;r.update(v,!1);return x(0,!1)}function x(b,n){if(b){for(var k=r;b--&&k.parent;)k=k.parent;k.redraw(0,!0);return k.vm}r.hooks&&h.execAll(r.hooks.willRedraw);r.refs={};var k=r.node,l=r.render.call(r.api,r,c,v),l=m(l,d,g,r);l.vm=r;r.node=
l;var e=h.isVal(v)&&"^"===v[0]?v.substr(1):h.isVal(l.ref)&&"^"===l.ref[0]?l.ref.substr(1):null;l.key=h.isVal(v)?v:l.key;for(var w=d;w;)w.vm&&(r.parent||(r.parent=w.vm),null!==e&&(w.vm.refs[e]=l)),w=w.parent;if((e=k)&&(l.type!==k.type||l.tag!==k.tag))var e=null,L=!0;f(l,e);d&&(d.body[g]=l);!1!==n&&(k&&a(k),!k&&p||C(l,null,l.el),L&&(k.el.parentNode.replaceChild(l.el,k.el),k.el=null));Promise.resolve().then(function(){r.hooks&&h.execAll(r.hooks.didRedraw)});return r}function w(b){r.hooks&&h.execAll(r.hooks.willUnmount);
if(d)if(b){for(b=g+1;b<d.body.length;b++){var c=d.body[b];c.idx=b-1;c.vm&&c.vm.updIdx(c.idx)}d.body.splice(g,1)}else d.body[g]=null;a(r.node,!0);r.node.vm=null;r.hooks&&h.execAll(r.hooks.didUnmount)}var p=!d;h.isArr(b)&&(c=b[1],v=b[2],n=b[3],b=b[0]);v=B(c,v);var r={api:{},node:null,view:[b,v],model:c,opts:n||{},render:null,update:function(b,d){null==b||v===c&&!h.isVal(v)||(c=r.model=b);return!1!==d?x(0):r},on:function(b,c){l(r.events,b,c)},hook:function(b,c){r.hooks=r.hooks||{};l(r.hooks,b,c)},events:{},
hooks:null,redraw:I.useRaf?h.raft(x):x,patch:function(b,c){var d=b.parent,g=f(m(c,d,b.idx,r),b);d.body[b.idx]=g},emit:function(b){for(var c=Array.prototype.slice.call(arguments,1),d=r;d;){if(d.events[b]){h.execAll(d.events[b],c);break}d=d.parent}},refs:{},parent:null,mount:function(b,c){var d=null;c&&(b.textContent="",d=b,b=null);C(r.node,d,null,b);return r},attach:function(b){e(r.node,b);return r},unmount:function(){z(r.hooks,"Unmount",w,[])},moveTo:k,updIdx:function(b){g=b}};n&&n.hooks&&r.hook(n.hooks);
h.execAll(G,[r]);r.render=b.call(r.api,r,c,v);return d?k(d,g):x(0)}function e(b,c){b.el=c;c._node=b;for(var v in b.props){var n=b.props[v],d=h.isEvProp(v)?v:"."===v[0]?v.substr(1):null;null!==d&&(c[d]=n)}if(h.isArr(b.body))for(v=0;v<b.body.length;v++)e(b.body[v],c.childNodes[v])}function a(b,c){h.isArr(b.body)&&(b.body.forEach(function(b,c){b&&(b.vm&&!b.moved?b.vm.unmount():a(b,!0))}),b.body=null);b.vm=null;c&&b.el&&b.el.parentNode&&z(b.hooks,"Remove",y,[b])}function y(b){b.el.parentNode.removeChild(b.el);
b.el=null}function m(b,c,v,n){var d=b,g={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,hooks:null,tag:null,ns:null,guard:!1,raw:!1,props:null,el:null,hasKeys:!1,body:null};h.isFunc(d)&&(d=d());if(h.isArr(d)&&d.length){g.type=h.TYPE_ELEM;if(1<d.length){var l=1;h.isObj(d[1])&&(g.props=d[1],l=2);g.body=d.length==l+1?h.isVal(d[l])?d[l]:h.isFunc(d[l])?d[l]():d.slice(l):d.slice(l)}d=d[0];if(/[.#]/.test(d)){if(d=D(d),g.tag=d.tag,d.id||d["class"])g.props=g.props||{},g.props.id=d.id,g.props["class"]=
d["class"]}else g.tag=d;if(g.props){var d=g.props,k;for(k in d)h.isEvProp(k)?d[k]=x(d[k],n.opts.evctx||n.model||null,g,n):h.isFunc(d[k])&&("href"==k?(d.onclick=d[k],d.href=d[k].href):d[k]=d[k]()),h.isDynProp(g.tag,k)&&(d["."+k]=d[k]);if(h.isObj(d.style))for(var a in d.style)k=d.style[a],h.isFunc(k)&&(d.style[a]=k());h.isObj(d._hooks)&&(g.hooks=d._hooks,d._hooks=null);g.key=h.isVal(d._key)?d._key:h.isVal(d._ref)?d._ref:h.isVal(d.id)?d.id:h.isVal(d.name)?d.name:null;d._ref&&(g.ref=d._ref);d._raw&&(g.raw=
!0);d._data&&(g.data=d._data);d._guard&&(g.guard=!0);d._ref=d._key=d._raw=d._data=d._guard=null}}else h.isVal(d)&&(g.type=h.TYPE_TEXT,g.body=d);null!==g.ref&&(n.refs[g.ref]=g);g.parent=c;g.idx=v;g.ns=c&&c.ns?c.ns:"svg"===g.tag||"math"===g.tag?g.tag:null;if(h.isArr(g.body))for(c=0,v=g.body.length;c<v;c++){a=g.body[c];var d=k=null,e=l=!1;h.isFunc(a)&&(a=a());if(null==a)l=!0;else{var f=h.isArr(a),w=f?!1:h.isObj(a);if(f)a.length?h.isArr(a[0])?e=!0:h.isFunc(a[0])?k=B(b[1],b[2]):(d=m(a,g,c,n),k=d.key):
l=!0;else if(w)if(h.isFunc(a.redraw))a.moveTo(g,c),d=a.node,k=a.view[1];else{g.body[c--]=""+a;continue}else""===a?l=!0:0<c&&g.body[c-1].type===h.TYPE_TEXT?(g.body[c-1].body+=""+a,l=!0):d=m(""+a,g,c,n)}l||e?(e?h.insertArr(g.body,a,c,1):g.body.splice(c,1),v=g.body.length,c--):(null!==k&&(g.hasKeys=!0),g.body[c]=d||a)}return g}function f(b,c){c&&z(b.hooks,"Recycle",q,[c,b]);if(h.isArr(b.body)){var a=0;b.body.forEach(function(n,d){var g=h.isArr(n);if(c){var l=p(n,b,c,a);if(null!==l){var k=l[0],l=l[1];
k===a&&a++;k=c.body[k];g&&k.vm?2===l?k.vm.moveTo(b,d,n[1]):1===l&&t(n[0],n[1],n[2],n[3],b,d):b.body[d]=f(n,k);return}}g?t(n[0],n[1],n[2],n[3],b,d):b.body[d]=f(n)})}return b}function C(b,c,a,n){var d=!b.el;d&&b.vm&&b.vm.hooks&&h.execAll(b.vm.hooks.willMount);if(b.type==h.TYPE_ELEM)if(d&&(b.el=c||(b.ns?J.createElementNS(E[b.ns],b.tag):J.createElement(b.tag)),b.props&&w(b)),h.isArr(b.body)){c=0;for(var g=b.el.firstChild;c<b.body.length;c++)g=C(b.body[c],null,g)?g:g.nextSibling||null}else h.isVal(b.body)&&
(b.raw?b.el.innerHTML=b.body:d&&(b.el.textContent=b.body));else b.type==h.TYPE_TEXT&&d&&(b.el=J.createTextNode(b.body));c=!0;b.el._node=b;a===b.el&&(c=!1);g=b.parent;c&&(n||g&&g.el)&&(z(b.hooks,d?"Insert":"Reinsert",A,[b,a,n]),c=!0);d&&b.vm&&b.vm.hooks&&h.execAll(b.vm.hooks.didMount);return c}function A(b,c,a){(a||b.parent.el).insertBefore(b.el,c)}function p(b,c,a,n,d){var g=h.isArr(b),l=g?b[2]||null:b.key,k=a.hasKeys,e=c.hasKeys;a=a.body;c=c.body;if(null!==l&&k&&(l=h.indexOfKey(l,a),-1<l))return[l,
2];n=n||0;if(n>a.length-1)return null;d=0===d?0:d||a.length-1;for(l=null;n<=d;n++)if(k=a[n],null!==k&&k.el)if(g&&k.vm){if(k.vm.view[0]===b[0]){if(k.vm.view[1]===B(b[1],b[2]))return[n,2];var f=!1;if(I.viewScan)for(var w=0;w<c.length;w++){var x=c[w];if(!x.el&&x.vm&&x.vm.view[0]===k.vm.view[0]&&x.vm.view[1]===k.vm.view[1]){f=!0;break}}f||l||!e||-1!=h.indexOfKey(k.key,c)||(l=[n,1])}}else if(b.type===k.type&&(b.type===h.TYPE_TEXT||null!==b.tag&&b.tag===k.tag)&&(null===k.key||!e||-1==h.indexOfKey(k.key,
c)))return[n,1];return l}function q(b,c){c.el=b.el;b.el=null;if(c.type===h.TYPE_TEXT&&c.body!==b.body)c.el.nodeValue=c.body;else{w(c,b);var a=!h.isArr(c.body),n=!h.isArr(b.body);a&&c.body!==b.body?n&&c.el.firstChild?c.el.firstChild.nodeValue=c.body:c.raw?c.el.innerHTML=c.body:c.el.textContent=c.body:n&&!a&&(c.el.textContent="");b.moved=!0}}function z(b,c,a,n,d,g){if(b){var l=b["will"+c];h.isArr(l)&&(l=l[0]);var k=b["did"+c];h.isArr(k)&&(k=k[0]);b=function(){a.apply(null,n);k&&k.apply(null,g||d||n)};
l?(l=l.apply(null,d||n),h.isProm(l)?l.then(b):b()):b()}else a.apply(null,n)}function D(b){if(b in K)return K[b];var c={tag:null,id:null,"class":null};c.tag=b.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,function(b,a,d,g){d&&(c.id=d);g&&(c["class"]=g.replace(/\./g," ").trim());return a||"div"});return K[b]=c}function x(b,c,a,n){return function(d){var a,l=d.target._node,k=null;if(h.isFunc(b))a=b.call(c,d,l,n);else if(h.isArr(b))k=b.slice(1),a=b[0].apply(c,k.concat(d,l,n));else if(h.isObj(b))for(var e in b){var f=
b[e];d.target.matches(e)&&(h.isArr(f)?(k=f.slice(1),a=f[0].apply(c,k.concat(d,l,n))):h.isFunc(f)&&(a=f.call(c,d,l,n)))}!1===a&&(d.preventDefault(),d.stopPropagation());n.opts.hasOwnProperty("watch")&&n.opts.watch.fire({type:"event",vm:n,node:l,event:d,data:k})}}function w(b,c){var a=!c;c=c||{};if(c.props||b.props){var n=c.props||{},d=b.props||{},g=n.style,l=d.style;if(h.isObj(g)||h.isObj(l))F(b.el,b.tag,g||{},l||{},M,N,b.ns,a),n.style=d.style=null;F(b.el,b.tag,n,d,O,H,b.ns,a);l&&(d.style=l)}}function F(b,
c,a,h,d,g,l,k){for(var f in h)null!==h[f]&&("."===f[0]?b[f.substr(1)]!==h[f]:h[f]!==a[f])&&d(b,f,h[f],l,k);for(f in a)null!==a[f]&&null==h[f]&&g(b,f,l,k)}function M(b,c,a){b.style[c]=h.autoPx(c,a)}function N(b,c){b.style[c]=""}function O(b,c,a,f,d){"."===c[0]?(c=c.substr(1),"svg"===f?b[c].baseVal=a:b[c]=a):"class"===c?b.className=a:"id"===c||h.isEvProp(c)?b[c]=a:!1===a?H(b,c,f,d):b.setAttribute(c,!0===a?"":a)}function H(b,c,a,f){f||("."===c[0]?(c=c.substr(1),"svg"===a?b[c].baseVal=null:b[c]=null):
"class"===c?b.className="":"id"===c||h.isEvProp(c)?b[c]=null:b.removeAttribute(c))}var E={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},K={},J="undefined"==typeof document?{}:document,I={useRaf:!0,viewScan:!1,useDOM:!1};u.view=t;u.view.config=function(b){I=b};var G=null;u.view.extend=function(b,c){G=!G||c?[]:G;G.push(b)};var h=u.util;return u})(domvm);(function(u){var B=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,t=u.util;u.html=function(e){var a="";switch(e.type){case t.TYPE_ELEM:a+="<"+e.tag;if(e.props){var y=t.isVal(e.props.style)?e.props.style:"",m=t.isObj(e.props.style)?e.props.style:null;if(m)for(var f in m)null!==m[f]&&(y+=t.camelDash(f)+": "+t.autoPx(f,m[f])+"; ");for(f in e.props)t.isEvProp(f)||"."===f[0]||(m=e.props[f],t.isFunc(m)&&(m=m()),t.isObj(m)||(!0===m?a+=" "+f:!1!==m&&null!==m&&
"."!==f[0]&&(a+=" "+f+'="'+m+'"')));y.length&&(a+=' style="'+y.trim()+'"')}if(e.ns&&"svg"!==e.tag&&"math"!==e.tag&&!e.body)return a+"/>";a+=">";break;case t.TYPE_TEXT:return e.body}B.test(e.tag)||(t.isArr(e.body)?e.body.forEach(function(f){a+=u.html(f)}):a+=e.body||"",a+="</"+e.tag+">");return a}})(domvm);(function(u){var B=u.util;u.watch=function(t){function e(){}function a(a,C,A,p,q){q=q||{};q.method=(q.method||a).toUpperCase();if(null!==A){var z=Object.prototype.toString.call(A);"[object Array]"===z||"[object Object]"===z?(q.headers=q.headers||new Headers,q.headers.set("Content-Type","application/json"),q.body=JSON.stringify(A)):q.body=""+A}var z=p,D=e;p instanceof Array&&(z=p[0],p[1]&&(D=p[1]));var x={type:"fetch",fetch:{method:a,url:C,body:A}};p=fetch(C,q).then(function(a){if(200<=a.status&&300>
a.status)return a;var f=Error(a.status+": "+a.statusText);f.data=a;return Promise.reject(f)}).then(function(a){switch(a.headers.get("Content-Type").split("; ")[0]){case "application/json":return a.json();case "text/plain":return a.text();default:return a}}).then(z,D).then(function(a){!1!==a&&m.fire(x);return a},function(a){x.error=a;m.fire(x);return a});p._fetchArgs=[a,C,A,[z,D],q];return p}var y=[];B.isFunc(t)&&y.push(t);var m={on:function(a){y.push(a);return m},off:function(a){y.splice(y.indexOf(a),
1);return m},fire:B.raft(function(){B.execAll(y,arguments);return m}),prop:function(f,C){var A=f,p=function(a,f){if(arguments.length&&a!==A){var e=A;A=a;!1!==f&&m.fire({type:"prop",prop:p,data:{old:e,"new":a}})}return A};if(C&&C.then){p.update=e;if(C._fetchArgs){var q=C._fetchArgs[3];C._fetchArgs[3]=[function(a){return p(q[0]?q[0](a):a)},q[1]];p.update=function(){a.apply(null,C._fetchArgs)}}C.then(p)}return p.toString=p},sync:function(a,e,m){var p=a,q=e;"string"==typeof a&&(p=function(e){return"e."===
a.substr(0,2)?e[a.substr(2)]:e.target[a]});return function(a,f){var x=this!==window?this:null;x&&"string"==typeof e&&(q=function(a,f){var m=x[e];x[e]=a;t&&a!==m&&!1!==f&&t()});q(p(f),m)}},get:function(f,e,m){return a("get",f,null,e,m)},"delete":function(f,e,m){return a("delete",f,null,e,m)},post:function(f,e,m,p){return a("post",f,e,m,p)},put:function(e,m,A,p){return a("put",e,m,A,p)},patch:function(e,m,A,p){return a("patch",e,m,A,p)}};return m}})(domvm);(function(u){function B(a,e,m,p,q,z){var t=null,x=null,w=null;if("/"==m[0]){w=m;x=!1;p={};z=w.split("#");e=z[0].split("?");t=e[0];z=z[1];e[1]&&(q={},e[1].split("&").map(function(a){a=a.split("=");q[a[0]]=null==a[1]?!0:a[1]}));var F,y;for(y in a){m=a[y];var u=m.path;if(F=t.match(m.regexPath)){x=y;-1!==u.indexOf(":")&&(p={},F.shift(),u.replace(/:([^\/]+)/g,function(a,e){p[e]=F.shift()}));break}}}else{x=m;m=a[x];var u=e+m.path,B=m.vars||{},H=/^[^\/]+$/,w=-1!==u.indexOf(":")?t=u.replace(/:([^\/]+)/g,
function(a,e){if((B[e]||H).test(p[e]))return p[e]+="";throw Error("Invalid value for route '"+u+"' segment '"+e+"': '"+p[e]+"'");}):t=u;if(q){var w=w+"?",E;for(E in q)w+=E+(!0!==q[E]?"="+q[E]:"")+"&";w=w.slice(0,-1)}w+=z?"#"+z:""}return{href:w,name:x,path:t,segs:p,hash:z,query:q}}function t(a,e){for(var m in a){var p=a[m];p.regexPath=new RegExp("^"+e+p.path.replace(/:([^\/]+)/g,function(a,e){var f=""+p.vars[e];return"("+f.substring(1,f.lastIndexOf("/"))+")"})+"$")}}var e=[],a=null,y=!1,m="";u.route=
function(f,u){function A(){var a=location,a=y?a.href.substr(a.origin.length):a.hash.substr(1)||"/";return B(D,m,a)}var p=null,q={href:function(a,e,f,p,t){var u=B(D,m,a,e,f,p);return y?(a=function(a){q["goto"](u,null,null,null,t);a.preventDefault()},a.href=u.href,a):"#"+u.href},config:function(a){(y=a.useHist)&&(m=a.root||"");p=a.init||null},refresh:function(){q["goto"](A(),null,null,null,!0)},"goto":function(f,p,q,t,u){u=u||z;f.href||(f=B(D,m,f,p,q,t));if(!1===f.name)console.log("Could not find route");
else{p=null;for(q=0;q<e.length;q++)if(e[q].path===f.path){p=q;break}null===p&&(e.splice(a+1,1E4),e.push(f),p=e.length-1);f=e[a];q=e[p];t=!0;null!==a&&(t=(t=D[f.name].onexit)?t.apply(null,(f?[f.segs,f.query,f.hash]:[]).concat(q)):!0);if(!1!==t&&!1!==D[q.name].onenter.apply(null,(q?[q.segs,q.query,q.hash]:[]).concat(f))){if(y)history[u?"replaceState":"pushState"](null,"title",q.href);a=p}z=!1}},location:function(){return z?A():e[a]}},z=!0,D=f(q,u);t(D,m);window.onhashchange=window.onpopstate=function(a){(y||
"popstate"!=a.type)&&q["goto"](A(),null,null,null,!0)};p&&p();return q}})(domvm);
