/*
 https://github.com/leeoniya/domvm
*/
("undefined"!==typeof global?global:this).domvm={};(function(v){var w="undefined"==typeof window?{}:window,q={TYPE_ELEM:1,TYPE_TEXT:2,isArr:function(b){return b instanceof Array},isVal:function(b){b=typeof b;return"string"===b||"number"===b},isObj:function(b){return"object"===typeof b&&null!==b&&!q.isArr(b)},isFunc:function(b){return"function"===typeof b},execAll:function(b,l){b.forEach(function(b){return b.apply(null,l)})},insertArr:function(b,l,m,h){b.splice.apply(b,[m,h].concat(l))},isEvProp:function(b){return"on"===b.substr(0,2)},camelDash:function(b){return b.replace(/([a-z])([A-Z])/g,
"$1-$2").toLowerCase()},raft:function(b){function l(){m=0;b.apply(h,f)}if(!w.requestAnimationFrame)return b;var m,h,f;return function(){h=this;f=arguments;m||(m=w.requestAnimationFrame(l))}}};v.util=q})(domvm);(function(v){function w(a,e,g,y,c,f,x){function k(a,c,e){f=a;x=c;return u(e,!1)}function u(a,c){n.execAll(p.events.willRedraw);p.imp=null!=a?a:y;p.refs={};var k=p.node,d=p.render.call(e,p.imp),d=l(d,f,x,p);d.key=n.isVal(g)?g:d.key;d.vm=p;p.node=d;var z=k;if(k&&(d.type!==k.type||d.tag!==k.tag))var z=null,r=!0;m(d,z);f&&(f.body[x]=d);!1!==c&&(k&&b(k),!k&&t||h(d),r&&(k.el.parentNode.replaceChild(d.el,k.el),k.el=null));setTimeout(function(){var a=p,c;for(c in a.refs)a.refs[c]=a.refs[c].el;n.execAll(p.events.didRedraw)},
0);return p}function d(a){var c=null,e=a.split(":");2==e.length&&(a=e[0],c=+e[1]);var e=Array.prototype.slice.call(arguments,1),g=p.node;if(null!==c){for(;c&&g.parent;)g=g.parent,g.vm&&c--;(c=(c=g.vm?g.vm.events:null)?c[a]:null)&&c.apply(null,e)}else for(;g&&(!g.vm||!(c=(c=g.vm.events)?c[a]:null)||!1!==c.apply(null,e));)g=g.parent}var t=!f;n.isArr(a)&&(e=a[1],g=a[2],y=a[3],c=a[4],a=a[0]);!1===g&&(y=e,g=e=null);var p={exp:{},imp:y||{},node:null,view:[a,e,g],opts:c||{},render:null,on:function(a,c){if(c)p.events[a].push(c);
else for(var e in a)p.events[e].push(a[e])},events:{willRedraw:[],didRedraw:[],willDestroy:[],didDestroy:[]},redraw:B.useRaf?n.raft(u):u,patch:function(a,c){var e=a.parent,g=m(l(c,e,a.idx,p),a);e.body[a.idx]=g;var f=g.key;n.isVal(f)&&(e.keyMap[f]=g)},emit:d,refs:{},mount:function(a,c){c&&(a.textContent="");h(p.node,c?a:null);c||a.insertBefore(p.node.el,null);return p},attach:function(a){q(p.node,a);return p},destroy:function(a){n.execAll(p.events.willDestroy);if(f)if(a){for(a=x+1;a<f.body.length;a++){var c=
f.body[a];c.idx=a-1;c.vm&&c.vm.updIdx(c.idx)}f.body.splice(x,1)}else f.body[x]=null;b(p.node,!0);p.node.vm=null;n.execAll(p.events.didDestroy)},moveTo:k,updIdx:function(a){x=a}};p.events._redraw=p.redraw;p.render=a.call(p.exp,p,e,g,y);d.redraw=function(a){a=n.isVal(a)?a:1E3;d("_redraw:"+a)};return f?k(f,x,y):u(y)}function q(a,e){a.el=e;if(n.isArr(a.body))for(var g=0;g<a.body.length;g++)q(a.body[g],e.childNodes[g])}function b(a,e){n.isArr(a.body)&&(a.body.forEach(function(a,e){a&&(a.vm&&!a.moved?a.vm.destroy():
a.el&&a.el.parentNode?a.el.parentNode.removeChild(a.el):b(a))}),a.body=null);a.vm=null;e&&a.el&&(a.el.parentNode.removeChild(a.el),a.el=null)}function l(a,e,g,f){var c=a;a={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,tag:null,ns:null,guard:!1,raw:!1,props:null,el:null,keyMap:null,body:null};n.isFunc(c)&&(c=c());if(n.isArr(c)&&c.length){a.type=n.TYPE_ELEM;if(1<c.length){var b=1;n.isObj(c[1])&&(a.props=c[1],b=2);a.body=c.length==b+1?n.isVal(c[b])?c[b]:n.isFunc(c[b])?c[b]():c.slice(b):
c.slice(b)}c=c[0];if(/[.#]/.test(c)){if(c=A(c),a.tag=c.tag,c.id||c["class"])a.props=a.props||{},a.props.id=c.id,a.props["class"]=c["class"]}else a.tag=c;if(a.props){var c=a.props,d;for(d in c)n.isEvProp(d)?c[d]=r(c[d],f.opts.evctx||f.view[1]||f.imp||null,a,f):n.isFunc(c[d])&&("href"==d?(c.onclick=c[d],c.href=c[d].url):c[d]=c[d]());if(n.isObj(c.style))for(var k in c.style)d=c.style[k],n.isFunc(d)&&(c.style[k]=d());a.key=n.isVal(c._key)?c._key:n.isVal(c._ref)?c._ref:n.isVal(c.id)?c.id:n.isVal(c.name)?
c.name:null;c._ref&&(a.ref=c._ref);c._raw&&(a.raw=!0);c._guard&&(a.guard=!0);c._ref=c._key=c._raw=c._guard=null}}else n.isVal(c)&&(a.type=n.TYPE_TEXT,a.body=c);null!==a.ref&&(f.refs[a.ref]=a);a.parent=e;a.idx=g;a.ns=e&&e.ns?e.ns:"svg"===a.tag||"math"===a.tag?a.tag:null;if(n.isArr(a.body)){e={};g=!1;k=0;for(d=a.body.length;k<d;k++){var c=a.body[k],u=b=null,h=!1,t=!1;n.isFunc(c)&&(c=c());if(null==c)h=!0;else{var p=n.isArr(c),z=p?!1:n.isObj(c);if(p)c.length?n.isArr(c[0])?t=!0:n.isFunc(c[0])?b=c[2]:(u=
l(c,a,k,f),b=u.key):h=!0;else if(z)if(n.isFunc(c.redraw))c.moveTo(a,k),u=c.node,b=c.view[2];else{a.body[k--]=""+c;continue}else""===c?h=!0:0<k&&a.body[k-1].type===n.TYPE_TEXT?(a.body[k-1].body+=""+c,h=!0):u=l(""+c,a,k,f)}h||t?(t?n.insertArr(a.body,c,k,1):a.body.splice(k,1),d=a.body.length,k--):(n.isVal(b)&&(e[b]=k,g=!0),a.body[k]=u||c)}g&&(a.keyMap=e)}return a}function m(a,e){e&&t(e,a);n.isArr(a.body)&&a.body.forEach(function(g,b){var c=n.isArr(g);if(e){var d=f(g,a,e);if(null!==d){var u=d[1],d=e.body[d[0]];
c&&d.vm?2===u?d.vm.moveTo(a,b,g[3]):1===u&&w(g[0],g[1],g[2],g[3],g[4],a,b):a.body[b]=m(g,d);return}}c?w(g[0],g[1],g[2],g[3],g[4],a,b):a.body[b]=m(g)});return a}function h(a,e){var g=!a.el;a.type==n.TYPE_ELEM?(g&&(a.el=e&&e.nodeName?e:a.ns?C.createElementNS(F[a.ns],a.tag):C.createElement(a.tag),a.props&&d(a)),n.isArr(a.body)?a.body.forEach(h):g&&n.isVal(a.body)&&(a.raw?a.el.innerHTML=a.body:a.el.textContent=a.body)):a.type==n.TYPE_TEXT&&g&&(a.el=C.createTextNode(a.body));a.el._node=a;(g=a.parent)&&
g.el&&g.el.childNodes[a.idx]!==a.el&&g.el.insertBefore(a.el,g.el.childNodes[a.idx])}function f(a,e,g,b,c){var f=n.isArr(a),d=f?a[2]||null:a.key,k=g.keyMap,u=e.keyMap;g=g.body;e=e.body;if(null!==d&&k&&n.isVal(k[d]))return[k[d],2];b=b||0;if(b>g.length-1)return null;c=0===c?0:c||g.length-1;for(d=null;b<=c;b++)if(k=g[b],null!==k&&k.el)if(f&&k.vm){if(k.vm.view[0]===a[0]){if(k.vm.view[1]===a[1])return[b,2];var h=!1;if(B.viewScan)for(var l=0;l<e.length;l++){var t=e[l];if(!t.el&&t.vm&&t.vm.view[0]===k.vm.view[0]&&
t.vm.view[1]===k.vm.view[1]){h=!0;break}}h||d||!u||n.isVal(u[k.key])||(d=[b,1])}}else if(!(a.type!==k.type||a.type!==n.TYPE_TEXT&&(null===a.tag||a.tag!==k.tag)||null!==k.key&&u&&n.isVal(u[k.key])))return[b,1];return d}function t(a,e){e.el=a.el;a.el=null;if(e.type===n.TYPE_TEXT&&e.body!==a.body)e.el.nodeValue=e.body;else{d(e,a);var g=!n.isArr(e.body),b=!n.isArr(a.body);g&&e.body!==a.body?b&&e.el.firstChild?e.el.firstChild.nodeValue=e.body:e.raw?e.el.innerHTML=e.body:e.el.textContent=e.body:b&&!g&&
(e.el.textContent="");a.moved=!0}}function A(a){if(a in D)return D[a];var e={tag:null,id:null,"class":null};e.tag=a.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,function(a,b,c,d){c&&(e.id=c);d&&(e["class"]=d.replace(/\./g," ").trim());return b||"div"});return D[a]=e}function r(a,e,g,b){return function(c){var d;if(n.isFunc(a))d=a.call(e,c,g,b);else if(n.isObj(a))for(var f in a)c.target.matches(f)&&(d=a[f].call(e,c,g,b));!1===d&&(c.preventDefault(),c.stopPropagation());b.opts.hasOwnProperty("watch")&&
b.opts.watch.fire({vm:b})}}function d(a,e){var b=!e;e=e||{};if(e.props||a.props){var d=e.props||{},c=a.props||{},f=d.style,h=c.style;if(n.isObj(f)||n.isObj(h))u(a.el,f||{},h||{},G,z,a.ns,b),d.style=c.style=null;u(a.el,d,c,H,E,a.ns,b);h&&(c.style=h)}}function u(a,e,b,d,c,f,n){for(var k in b)null!==b[k]&&(k in e&&b[k]===e[k]||d(a,k,b[k],f,n));for(k in e)null!==e[k]&&(k in b||c(a,k,f,n))}function G(a,e,b){a.style[e]=isNaN(b)||I[e]?b:b+"px"}function z(a,e){a.style[e]=""}function H(a,e,b,d,c){"."===e[0]?
(e=e.substr(1),"svg"===d?a[e].baseVal=b:a[e]=b):"class"===e?a.className=b:"id"===e||n.isEvProp(e)?a[e]=b:!1===b?E(a,e,d,c):(!0===b&&(b=""),a.setAttribute(e,b))}function E(a,b,d,f){f||("."===b[0]?(b=b.substr(1),"svg"===d?a[b].baseVal=null:a[b]=null):"class"===b?a.className="":"id"===b||n.isEvProp(b)?a[b]=null:a.removeAttribute(b))}var F={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},D={},C="undefined"==typeof document?{}:document,I={animationIterationCount:!0,boxFlex:!0,
boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},B={useRaf:!0,viewScan:!1,useDOM:!1};v.view=w;v.config=function(a){B=a};var n=v.util;return v})(domvm);(function(v){var w=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,q=v.util;v.html=function(b){var l="";switch(b.type){case q.TYPE_ELEM:l+="<"+b.tag;if(b.props){var m=q.isVal(b.props.style)?b.props.style:"",h=q.isObj(b.props.style)?b.props.style:null;if(h)for(var f in h)null!==h[f]&&(m+=q.camelDash(f)+": "+h[f]+";");for(f in b.props)q.isEvProp(f)||(h=b.props[f],q.isFunc(h)&&(h=h()),q.isObj(h)||(!0===h?l+=" "+f:!1!==h&&null!==h&&"."!==f[0]&&(l+=" "+f+'="'+
h+'"')));m.length&&(l+=' style="'+m+'"')}if(b.ns&&"svg"!==b.tag&&"math"!==b.tag&&!b.body)return l+"/>";l+=">";break;case q.TYPE_TEXT:return b.body}w.test(b.tag)||(q.isArr(b.body)?b.body.forEach(function(b){l+=v.html(b)}):l+=b.body||"",l+="</"+b.tag+">");return l}})(domvm);(function(v){var w=v.util;v.watch=function(q){function b(){}function l(f,l,m,r,d){d=d||{};d.method=(d.method||f).toUpperCase();if(null!==m){var u=Object.prototype.toString.call(m);"[object Array]"===u||"[object Object]"===u?(d.headers=d.headers||new Headers,d.headers.set("Content-Type","application/json"),d.body=JSON.stringify(m)):d.body=""+m}var u=r,q=b;r instanceof Array&&(u=r[0],r[1]&&(q=r[1]));r=fetch(l,d).then(function(b){if(200<=b.status&&300>b.status)return b;var d=Error(b.statusText);d.resp=
b;throw d;}).then(function(b){switch(b.headers.get("Content-Type").split("; ")[0]){case "application/json":return b.json();case "text/plain":return b.text();default:return b}}).then(u,q).then(function(b){!1!==b&&h.fire();return b},b);r._fetchArgs=[f,l,m,[u,q],d];return r}var m=[];w.isFunc(q)&&m.push(q);var h={on:function(b){m.push(b);return h},off:function(b){m.splice(m.indexOf(b),1);return h},fire:function(){w.execAll(m,arguments);return h},prop:function(f,t){var m=f,r=function(b,d){arguments.length&&
b!==m&&(m=b,!1!==d&&h.fire());return m};if(t&&t.then){r.update=b;if(t._fetchArgs){var d=t._fetchArgs[3];t._fetchArgs[3]=[function(b){return r(d[0]?d[0](b):b)},d[1]];r.update=function(){l.apply(null,t._fetchArgs)}}t.then(r)}return r.toString=r},sync:function(b,h,l){var m=b,d=h;"string"==typeof b&&(m=function(d){return"e."===b.substr(0,2)?d[b.substr(2)]:d.target[b]});return function(b){var f=this!==window?this:null;f&&"string"==typeof h&&(d=function(b,d){var l=f[h];f[h]=b;q&&b!==l&&!1!==d&&q()});d(m(b),
l)}},get:function(b,h,m){return l("get",b,null,h,m)},"delete":function(b,h,m){return l("delete",b,null,h,m)},post:function(b,h,m,r){return l("post",b,h,m,r)},put:function(b,h,m,r){return l("put",b,h,m,r)},patch:function(b,h,m,r){return l("patch",b,h,m,r)}};return h}})(domvm);(function(v){v.route=function(v,q){function b(b,f){var h=A[b],l=r+h.url;if(f&&-1!==l.indexOf(":")){f=f.slice();var m=!0,l=l.replace(/:([^\/]+)/g,function(b,d){var l=f.shift();if(h.params&&h.params[d]){if((""+l).match(h.params[d]))return l;m=!1}else return l});return m?l:m}return l}var l=!0,m={href:function(){var d=arguments,f=function(b){m["goto"].apply(null,d);b.preventDefault()};f.url=b.apply(null,d);return f},"goto":function(d,m,r){m=m||[];r=r||l;var q=b(d,m);if(!1===q)console.log("Could not find route");
else{for(var t=null,v=0;v<f.length;v++)if(f[v].url===q){t=v;break}null===t&&(f.splice(h+1,1E4),f.push({name:d,route:A[d],params:m,url:q}),t=f.length-1);v=f[t];Array.prototype.slice.call(arguments);var w=!0;null!==h&&(w=f[h].route.onexit.call(null,f[t].params.concat(v)));!1!==w&&!1!==f[t].route.onenter.apply(null,m.concat(f[h]))&&(history[r?"replaceState":"pushState"]([d,m],"title",q),h=t);l=!1}},current:function(){return f[h]}},h=null,f=[],t=v(m,q),A=t.routes,r=t.root||"/";window.onpopstate=function(b){m["goto"].apply(null,
b.state.concat(!0))};return m}})(domvm);
