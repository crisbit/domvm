/*
 https://github.com/leeoniya/domvm
*/
("undefined"!==typeof global?global:this).domvm={};(function(v){var y="undefined"==typeof window?{}:window,q={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},n={TYPE_ELEM:1,TYPE_TEXT:2,isArr:function(a){return a instanceof
Array},isVal:function(a){a=typeof a;return"string"===a||"number"===a},isObj:function(a){return"object"===typeof a&&null!==a&&!n.isArr(a)},isFunc:function(a){return"function"===typeof a},isProm:function(a){return"object"===typeof a&&n.isFunc(a.then)},execAll:function(a,g){a&&(n.isArr(a)?a:[a]).forEach(function(a){return a.apply(null,g)})},insertArr:function(a,g,f,e){a.splice.apply(a,[f,e].concat(g))},isEvProp:function(a){return"on"===a.substr(0,2)},isDynProp:function(a,g){switch(a){case "input":case "textarea":case "select":case "option":switch(g){case "value":case "checked":case "selected":case "selectedIndex":return!0}}},
camelDash:function(a){return a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},autoPx:function(a,g){return isNaN(g)||q[a]?g:g+"px"},indexOfKey:function(a,g,f,e){for(f=0;f<g.length;f++)if(g[f].key===a)return f;return-1},raft:function(a){function g(){f=0;a.apply(e,x)}if(!y.requestAnimationFrame)return a;var f,e,x;return function(){e=this;x=arguments;f||(f=y.requestAnimationFrame(g))}}};v.util=n})(domvm);(function(v){function y(b,c){return!1===c?null:null==c&&null!=b?b:h.isVal(c)||h.isObj(c)||h.isArr(c)||h.isFunc(c)?c:null}function q(b,c,z,u,d,m){function k(b,c,d){if(d)b[c]=b[c]||[],b[c].push(d);else for(var a in c)b[a]=b[a]||[],b[a].push(c[a])}function l(b,c,a){d=b;m=c;p.update(a,!1);return A(0,!1)}function A(b,u){if(b){for(var l=p;b--&&l.parent;)l=l.parent;l.redraw(0,!0);return l.vm}p.hooks&&h.execAll(p.hooks.willRedraw);p.refs={};var l=p.node,k=p.render.call(p.api,p,c,z),k=f(k,d,m,p);k.vm=p;p.node=
k;var A=h.isVal(z)&&"^"===z[0]?z.substr(1):h.isVal(k.ref)&&"^"===k.ref[0]?k.ref.substr(1):null;k.key=h.isVal(z)?z:k.key;for(var g=d;g;)g.vm&&(p.parent||(p.parent=g.vm),null!==A&&(g.vm.refs[A]=k)),g=g.parent;if((A=l)&&(k.type!==l.type||k.tag!==l.tag))var A=null,F=!0;e(k,A);d&&(d.body[m]=k);!1!==u&&(l&&a(l),!l&&t||x(k,null,k.el),F&&(l.el.parentNode.replaceChild(k.el,l.el),l.el=null));Promise.resolve().then(function(){p.hooks&&h.execAll(p.hooks.didRedraw)});return p}function g(b){p.hooks&&h.execAll(p.hooks.willUnmount);
if(d)if(b){for(b=m+1;b<d.body.length;b++){var c=d.body[b];c.idx=b-1;c.vm&&c.vm.updIdx(c.idx)}d.body.splice(m,1)}else d.body[m]=null;a(p.node,!0);p.node.vm=null;p.hooks&&h.execAll(p.hooks.didUnmount)}var t=!d;h.isArr(b)&&(c=b[1],z=b[2],u=b[3],b=b[0]);z=y(c,z);var p={api:{},node:null,view:[b,z],model:c,opts:u||{},render:null,update:function(b,d){null!=b&&z!==c&&(c=p.model=b);return!1!==d?A(0):p},on:function(b,c){k(p.events,b,c)},hook:function(b,c){p.hooks=p.hooks||{};k(p.hooks,b,c)},events:{},hooks:null,
redraw:E.useRaf?h.raft(A):A,patch:function(b,c){var d=b.parent,a=e(f(c,d,b.idx,p),b);d.body[b.idx]=a},emit:function(b){for(var c=Array.prototype.slice.call(arguments,1),d=p;d;){if(d.events[b]){h.execAll(d.events[b],c);break}d=d.parent}},refs:{},parent:null,mount:function(b,c){p.hooks&&h.execAll(p.hooks.willMount);c&&(b.textContent="");x(p.node,c?b:null);c||b.insertBefore(p.node.el,null);p.hooks&&h.execAll(p.hooks.didMount);return p},attach:function(b){n(p.node,b);return p},unmount:function(){B(p.hooks,
"Unmount",g,[])},moveTo:l,updIdx:function(b){m=b}};u&&u.hooks&&p.hook(u.hooks);h.execAll(D,[p]);p.render=b.call(p.api,p,c,z);return d?l(d,m):A(0)}function n(b,c){b.el=c;if(h.isArr(b.body))for(var a=0;a<b.body.length;a++)n(b.body[a],c.childNodes[a])}function a(b,c){h.isArr(b.body)&&(b.body.forEach(function(b,c){b&&(b.vm&&!b.moved?b.vm.unmount():a(b,!0))}),b.body=null);b.vm=null;c&&b.el&&b.el.parentNode&&B(b.hooks,"Remove",g,[b])}function g(b){b.el.parentNode.removeChild(b.el);b.el=null}function f(b,
c,a,u){var d=b,m={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,hooks:null,tag:null,ns:null,guard:!1,raw:!1,props:null,el:null,hasKeys:!1,body:null};h.isFunc(d)&&(d=d());if(h.isArr(d)&&d.length){m.type=h.TYPE_ELEM;if(1<d.length){var k=1;h.isObj(d[1])&&(m.props=d[1],k=2);m.body=d.length==k+1?h.isVal(d[k])?d[k]:h.isFunc(d[k])?d[k]():d.slice(k):d.slice(k)}d=d[0];if(/[.#]/.test(d)){if(d=M(d),m.tag=d.tag,d.id||d["class"])m.props=m.props||{},m.props.id=d.id,m.props["class"]=d["class"]}else m.tag=
d;if(m.props){var d=m.props,l;for(l in d)h.isEvProp(l)?d[l]=F(d[l],u.opts.evctx||u.model||null,m,u):h.isFunc(d[l])&&("href"==l?(d.onclick=d[l],d.href=d[l].path):d[l]=d[l]()),h.isDynProp(m.tag,l)&&(d["."+l]=d[l]);if(h.isObj(d.style))for(var e in d.style)l=d.style[e],h.isFunc(l)&&(d.style[e]=l());h.isObj(d._hooks)&&(m.hooks=d._hooks,d._hooks=null);m.key=h.isVal(d._key)?d._key:h.isVal(d._ref)?d._ref:h.isVal(d.id)?d.id:h.isVal(d.name)?d.name:null;d._ref&&(m.ref=d._ref);d._raw&&(m.raw=!0);d._data&&(m.data=
d._data);d._guard&&(m.guard=!0);d._ref=d._key=d._raw=d._data=d._guard=null}}else h.isVal(d)&&(m.type=h.TYPE_TEXT,m.body=d);null!==m.ref&&(u.refs[m.ref]=m);m.parent=c;m.idx=a;m.ns=c&&c.ns?c.ns:"svg"===m.tag||"math"===m.tag?m.tag:null;if(h.isArr(m.body))for(c=0,a=m.body.length;c<a;c++){e=m.body[c];var d=l=null,g=k=!1;h.isFunc(e)&&(e=e());if(null==e)k=!0;else{var x=h.isArr(e),p=x?!1:h.isObj(e);if(x)e.length?h.isArr(e[0])?g=!0:h.isFunc(e[0])?l=y(b[1],b[2]):(d=f(e,m,c,u),l=d.key):k=!0;else if(p)if(h.isFunc(e.redraw))e.moveTo(m,
c),d=e.node,l=e.view[1];else{m.body[c--]=""+e;continue}else""===e?k=!0:0<c&&m.body[c-1].type===h.TYPE_TEXT?(m.body[c-1].body+=""+e,k=!0):d=f(""+e,m,c,u)}k||g?(g?h.insertArr(m.body,e,c,1):m.body.splice(c,1),a=m.body.length,c--):(null!==l&&(m.hasKeys=!0),m.body[c]=d||e)}return m}function e(b,c){c&&B(b.hooks,"Recycle",w,[c,b]);if(h.isArr(b.body)){var a=0;b.body.forEach(function(u,d){var m=h.isArr(u);if(c){var k=r(u,b,c,a);if(null!==k){var l=k[0],k=k[1];l===a&&a++;l=c.body[l];m&&l.vm?2===k?l.vm.moveTo(b,
d,u[1]):1===k&&q(u[0],u[1],u[2],u[3],b,d):b.body[d]=e(u,l);return}}m?q(u[0],u[1],u[2],u[3],b,d):b.body[d]=e(u)})}return b}function x(b,c,a){var e=!b.el;if(b.type==h.TYPE_ELEM)if(e&&(b.el=c&&c.nodeName?c:b.ns?G.createElementNS(N[b.ns],b.tag):G.createElement(b.tag),b.props&&J(b)),h.isArr(b.body)){c=0;for(var d=b.el.firstChild;c<b.body.length;c++)d=x(b.body[c],null,d)?d:d.nextSibling||null}else h.isVal(b.body)&&(b.raw?b.el.innerHTML=b.body:e&&(b.el.textContent=b.body));else b.type==h.TYPE_TEXT&&e&&(b.el=
G.createTextNode(b.body));b.el._node=b;if(a===b.el)return!1;if((c=b.parent)&&c.el)return B(b.hooks,e?"Insert":"Reinsert",t,[b,a]),!0}function t(b,c){b.parent.el.insertBefore(b.el,c)}function r(b,c,a,e,d){var m=h.isArr(b),k=m?b[2]||null:b.key,l=a.hasKeys,f=c.hasKeys;a=a.body;c=c.body;if(null!==k&&l&&(k=h.indexOfKey(k,a),-1<k))return[k,2];e=e||0;if(e>a.length-1)return null;d=0===d?0:d||a.length-1;for(k=null;e<=d;e++)if(l=a[e],null!==l&&l.el)if(m&&l.vm){if(l.vm.view[0]===b[0]){if(l.vm.view[1]===y(b[1],
b[2]))return[e,2];var g=!1;if(E.viewScan)for(var x=0;x<c.length;x++){var p=c[x];if(!p.el&&p.vm&&p.vm.view[0]===l.vm.view[0]&&p.vm.view[1]===l.vm.view[1]){g=!0;break}}g||k||!f||-1!=h.indexOfKey(l.key,c)||(k=[e,1])}}else if(b.type===l.type&&(b.type===h.TYPE_TEXT||null!==b.tag&&b.tag===l.tag)&&(null===l.key||!f||-1==h.indexOfKey(l.key,c)))return[e,1];return k}function w(b,c){c.el=b.el;b.el=null;if(c.type===h.TYPE_TEXT&&c.body!==b.body)c.el.nodeValue=c.body;else{J(c,b);var a=!h.isArr(c.body),e=!h.isArr(b.body);
a&&c.body!==b.body?e&&c.el.firstChild?c.el.firstChild.nodeValue=c.body:c.raw?c.el.innerHTML=c.body:c.el.textContent=c.body:e&&!a&&(c.el.textContent="");b.moved=!0}}function B(b,c,a,e,d,m){if(b){var k=b["will"+c];h.isArr(k)&&(k=k[0]);var l=b["did"+c];h.isArr(l)&&(l=l[0]);b=function(){a.apply(null,e);l&&l.apply(null,m||d||e)};k?(k=k.apply(null,d||e),h.isProm(k)?k.then(b):b()):b()}else a.apply(null,e)}function M(b){if(b in H)return H[b];var c={tag:null,id:null,"class":null};c.tag=b.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,
function(b,a,d,e){d&&(c.id=d);e&&(c["class"]=e.replace(/\./g," ").trim());return a||"div"});return H[b]=c}function F(b,c,a,e){return function(d){var a,k=d.target._node;if(h.isFunc(b))a=b.call(c,d,k);else if(h.isArr(b))a=b[0].apply(c,b.slice(1).concat(d,k));else if(h.isObj(b))for(var l in b){var f=b[l];d.target.matches(l)&&(h.isArr(f)?a=f[0].apply(c,f.slice(1).concat(d,k)):h.isFunc(f)&&(a=f.call(c,d,k)))}!1===a&&(d.preventDefault(),d.stopPropagation());e.opts.hasOwnProperty("watch")&&e.opts.watch.fire({vm:e,
node:k})}}function J(b,c){var a=!c;c=c||{};if(c.props||b.props){var e=c.props||{},d=b.props||{},m=e.style,k=d.style;if(h.isObj(m)||h.isObj(k))K(b.el,b.tag,m||{},k||{},I,C,b.ns,a),e.style=d.style=null;K(b.el,b.tag,e,d,O,L,b.ns,a);k&&(d.style=k)}}function K(b,c,a,e,d,h,k,l){for(var f in e)null!==e[f]&&(e[f]===a[f]&&"."!==f[0]||d(b,f,e[f],k,l));for(f in a)null!==a[f]&&null==e[f]&&h(b,f,k,l)}function I(b,c,a){b.style[c]=h.autoPx(c,a)}function C(b,c){b.style[c]=""}function O(b,c,a,e,d){"."===c[0]?(c=c.substr(1),
"svg"===e?b[c].baseVal=a:b[c]=a):"class"===c?b.className=a:"id"===c||h.isEvProp(c)?b[c]=a:!1===a?L(b,c,e,d):b.setAttribute(c,!0===a?"":a)}function L(b,c,a,e){e||("."===c[0]?(c=c.substr(1),"svg"===a?b[c].baseVal=null:b[c]=null):"class"===c?b.className="":"id"===c||h.isEvProp(c)?b[c]=null:b.removeAttribute(c))}var N={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},H={},G="undefined"==typeof document?{}:document,E={useRaf:!0,viewScan:!1,useDOM:!1};v.view=q;v.view.config=function(b){E=
b};var D=null;v.view.extend=function(b,c){D=!D||c?[]:D;D.push(b)};var h=v.util;return v})(domvm);(function(v){var y=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,q=v.util;v.html=function(n){var a="";switch(n.type){case q.TYPE_ELEM:a+="<"+n.tag;if(n.props){var g=q.isVal(n.props.style)?n.props.style:"",f=q.isObj(n.props.style)?n.props.style:null;if(f)for(var e in f)null!==f[e]&&(g+=q.camelDash(e)+": "+q.autoPx(e,f[e])+"; ");for(e in n.props)q.isEvProp(e)||"."===e[0]||(f=n.props[e],q.isFunc(f)&&(f=f()),q.isObj(f)||(!0===f?a+=" "+e:!1!==f&&null!==f&&
"."!==e[0]&&(a+=" "+e+'="'+f+'"')));g.length&&(a+=' style="'+g.trim()+'"')}if(n.ns&&"svg"!==n.tag&&"math"!==n.tag&&!n.body)return a+"/>";a+=">";break;case q.TYPE_TEXT:return n.body}y.test(n.tag)||(q.isArr(n.body)?n.body.forEach(function(e){a+=v.html(e)}):a+=n.body||"",a+="</"+n.tag+">");return a}})(domvm);(function(v){var y=v.util;v.watch=function(q){function n(){}function a(a,g,t,r,w){w=w||{};w.method=(w.method||a).toUpperCase();if(null!==t){var B=Object.prototype.toString.call(t);"[object Array]"===B||"[object Object]"===B?(w.headers=w.headers||new Headers,w.headers.set("Content-Type","application/json"),w.body=JSON.stringify(t)):w.body=""+t}var B=r,q=n;r instanceof Array&&(B=r[0],r[1]&&(q=r[1]));r=fetch(g,w).then(function(a){if(200<=a.status&&300>a.status)return a;var e=Error(a.status+": "+a.statusText);
e.data=a;return Promise.reject(e)}).then(function(a){switch(a.headers.get("Content-Type").split("; ")[0]){case "application/json":return a.json();case "text/plain":return a.text();default:return a}}).then(B,q).then(function(a){!1!==a&&f.fire();return a},function(a){f.fire();return a});r._fetchArgs=[a,g,t,[B,q],w];return r}var g=[];y.isFunc(q)&&g.push(q);var f={on:function(a){g.push(a);return f},off:function(a){g.splice(g.indexOf(a),1);return f},fire:y.raft(function(){y.execAll(g,arguments);return f}),
prop:function(e,g){var t=e,r=function(a,e){arguments.length&&a!==t&&(t=a,!1!==e&&f.fire());return t};if(g&&g.then){r.update=n;if(g._fetchArgs){var w=g._fetchArgs[3];g._fetchArgs[3]=[function(a){return r(w[0]?w[0](a):a)},w[1]];r.update=function(){a.apply(null,g._fetchArgs)}}g.then(r)}return r.toString=r},sync:function(a,f,g){var r=a,w=f;"string"==typeof a&&(r=function(f){return"e."===a.substr(0,2)?f[a.substr(2)]:f.target[a]});return function(a){var e=this!==window?this:null;e&&"string"==typeof f&&
(w=function(a,g){var t=e[f];e[f]=a;q&&a!==t&&!1!==g&&q()});w(r(a),g)}},get:function(e,f,g){return a("get",e,null,f,g)},"delete":function(e,f,g){return a("delete",e,null,f,g)},post:function(e,f,g,r){return a("post",e,f,g,r)},put:function(e,f,g,r){return a("put",e,f,g,r)},patch:function(e,f,g,r){return a("patch",e,f,g,r)}};return f}})(domvm);(function(v){function y(a,g,f){if("/"===g[0]){var e=g;g=null;var n,t;for(t in a)if(n=e.match(a[t].regexPath)){f=n.slice(1);g=t;break}null===g&&(g="_noMatch")}else e=q(a,g,f);return{name:g,route:a[g],params:f,path:e}}function q(a,g,f){var e=a[g];a=e.path;if(f&&-1!==a.indexOf(":")){f=f.slice();var n=!0;a=a.replace(/:([^\/]+)/g,function(a,g){var w=f.shift();if(e.params&&e.params[g]){if((""+w).match(e.params[g]))return w;n=!1}else return w});return n?a:n}return a}function n(a){for(var g in a){var f=a[g];
f.regexPath=new RegExp("^"+f.path.replace(/:([^\/]+)/g,function(a,g){var n=""+f.params[g];return"("+n.substring(1,n.lastIndexOf("/"))+")"})+"$")}}v.route=function(a,g){var f={href:function(a,e,g){var n=function(n){f["goto"](a,e,g);n.preventDefault()};n.path=q(r,a,e);return n},refresh:function(){f["goto"](window.location.pathname)},"goto":function(a,f,g){f=f||[];g=g||e;var n=y(r,a,f),q=n.path;a=n.name;f=n.params;if(!1===q)console.log("Could not find route");else{for(var n=null,v=0;v<t.length;v++)if(t[v].path===
q){n=v;break}null===n&&(t.splice(x+1,1E4),t.push({name:a,route:r[a],params:f,path:q}),n=t.length-1);var v=t[x],I=t[n];Array.prototype.slice.call(arguments);var C=!0;null!==x&&(C=(C=t[x].route.onexit)?C.apply(null,[{to:I}].concat(v?v.params:[])):!0);!1!==C&&!1!==t[n].route.onenter.apply(null,[{from:v}].concat(f))&&(history[g?"replaceState":"pushState"]([a,f],"title",q),x=n);e=!1}},current:function(){return e?y(r,window.location.pathname):t[x]}},e=!0,x=null,t=[],r=a(f,g);n(r);window.onpopstate=function(a){f["goto"].apply(null,
a.state.concat(!0))};return f}})(domvm);
