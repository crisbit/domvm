/*
 https://github.com/leeoniya/domvm
*/
("undefined"!==typeof global?global:this).domvm={};(function(u){var w="undefined"==typeof window?{}:window,t={TYPE_ELEM:1,TYPE_TEXT:2,isArr:function(b){return b instanceof Array},isVal:function(b){b=typeof b;return"string"===b||"number"===b},isObj:function(b){return"object"===typeof b&&null!==b&&!t.isArr(b)},isFunc:function(b){return"function"===typeof b},isProm:function(b){return"object"===typeof b&&t.isFunc(b.then)},execAll:function(b,k){b&&(t.isArr(b)?b:[b]).forEach(function(b){return b.apply(null,k)})},insertArr:function(b,k,q,m){b.splice.apply(b,
[q,m].concat(k))},isEvProp:function(b){return"on"===b.substr(0,2)},camelDash:function(b){return b.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},raft:function(b){function k(){q=0;b.apply(m,h)}if(!w.requestAnimationFrame)return b;var q,m,h;return function(){m=this;h=arguments;q||(q=w.requestAnimationFrame(k))}}};u.util=t})(domvm);(function(u){function w(a,d,x,f,c,y,r){function g(a,c,d){if(d)a[c]=a[c]||[],a[c].push(d);else for(var f in c)a[f]=a[f]||[],a[f].push(c[f])}function e(a,c,d){y=a;r=c;return k(0,d,!1)}function k(a,c,g){if(a){for(g=p;a--&&g.parent;)g=g.parent;g.redraw(0,c,!0);return g.vm}p.hooks&&l.execAll(p.hooks.willRedraw);p.imp=null!=c?c:f;p.refs={};a=p.node;c=p.render.call(p.exp,p,d,x,p.imp);c=q(c,y,r,p);c.key=l.isVal(x)?x:c.key;c.vm=p;p.node=c;for(var e="^"===(""+c.key)[0]?c.key.substr(1):null,n=y;n;)n.vm&&(p.parent||
(p.parent=n.vm),null!==e&&(n.vm.keys[e]=p)),n=n.parent;if((e=a)&&(c.type!==a.type||c.tag!==a.tag))var e=null,v=!0;m(c,e);y&&(y.body[r]=c);!1!==g&&(a&&b(a),!a&&A||h(c,null,c.el),v&&(a.el.parentNode.replaceChild(c.el,a.el),a.el=null));Promise.resolve().then(function(){var a=p,c;for(c in a.refs)a.refs[c]=a.refs[c].el;p.hooks&&l.execAll(p.hooks.didRedraw)});return p}function n(a){p.hooks&&l.execAll(p.hooks.willUnmount);if(y)if(a){for(a=r+1;a<y.body.length;a++){var c=y.body[a];c.idx=a-1;c.vm&&c.vm.updIdx(c.idx)}y.body.splice(r,
1)}else y.body[r]=null;b(p.node,!0);p.node.vm=null;p.hooks&&l.execAll(p.hooks.didUnmount)}var A=!y;l.isArr(a)&&(d=a[1],x=a[2],f=a[3],c=a[4],a=a[0]);!1===x&&(f=d,x=d=null);var p={exp:{},imp:f||{},node:null,view:[a,d,x],opts:c||{},render:null,on:function(a,c){g(p.events,a,c)},hook:function(a,c){p.hooks=p.hooks||{};g(p.hooks,a,c)},events:{},hooks:null,redraw:C.useRaf?l.raft(k):k,patch:function(a,c){var d=a.parent,f=m(q(c,d,a.idx,p),a);d.body[a.idx]=f;f=f.key;l.isVal(f)&&(d.keyMap[f]=a.idx)},emit:function(a){for(var c=
Array.prototype.slice.call(arguments,1),d=p;d;){if(d.events[a]){l.execAll(d.events[a],c);break}d=d.parent}},refs:{},parent:null,keys:{},mount:function(a,c){p.hooks&&l.execAll(p.hooks.willMount);c&&(a.textContent="");h(p.node,c?a:null);c||a.insertBefore(p.node.el,null);p.hooks&&l.execAll(p.hooks.didMount);return p},attach:function(a){t(p.node,a);return p},unmount:function(){v(p.hooks,"Unmount",n,[])},moveTo:e,updIdx:function(a){r=a}};p.render=a.call(p.exp,p,d,x,f);return y?e(y,r,f):k(0,f)}function t(a,
d){a.el=d;if(l.isArr(a.body))for(var x=0;x<a.body.length;x++)t(a.body[x],d.childNodes[x])}function b(a,d){l.isArr(a.body)&&(a.body.forEach(function(a,d){a&&(a.vm&&!a.moved?a.vm.unmount():b(a,!0))}),a.body=null);a.vm=null;d&&a.el&&a.el.parentNode&&v(a.hooks,"Remove",k,[a])}function k(a){a.el.parentNode.removeChild(a.el);a.el=null}function q(a,d,x,f){var c=a;a={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,hooks:null,tag:null,ns:null,guard:!1,raw:!1,props:null,el:null,keyMap:null,body:null};
l.isFunc(c)&&(c=c());if(l.isArr(c)&&c.length){a.type=l.TYPE_ELEM;if(1<c.length){var b=1;l.isObj(c[1])&&(a.props=c[1],b=2);a.body=c.length==b+1?l.isVal(c[b])?c[b]:l.isFunc(c[b])?c[b]():c.slice(b):c.slice(b)}c=c[0];if(/[.#]/.test(c)){if(c=z(c),a.tag=c.tag,c.id||c["class"])a.props=a.props||{},a.props.id=c.id,a.props["class"]=c["class"]}else a.tag=c;if(a.props){var c=a.props,r;for(r in c)l.isEvProp(r)?c[r]=H(c[r],f.opts.evctx||f.view[1]||f.imp||null,a,f):l.isFunc(c[r])&&("href"==r?(c.onclick=c[r],c.href=
c[r].url):c[r]=c[r]());if(l.isObj(c.style))for(var g in c.style)r=c.style[g],l.isFunc(r)&&(c.style[g]=r());l.isObj(c._hooks)&&(a.hooks=c._hooks,c._hooks=null);a.key=l.isVal(c._key)?c._key:l.isVal(c._ref)?c._ref:l.isVal(c.id)?c.id:l.isVal(c.name)?c.name:null;c._ref&&(a.ref=c._ref);c._raw&&(a.raw=!0);c._guard&&(a.guard=!0);c._ref=c._key=c._raw=c._guard=null}}else l.isVal(c)&&(a.type=l.TYPE_TEXT,a.body=c);null!==a.ref&&(f.refs[a.ref]=a);a.parent=d;a.idx=x;a.ns=d&&d.ns?d.ns:"svg"===a.tag||"math"===a.tag?
a.tag:null;if(l.isArr(a.body)){d={};x=!1;g=0;for(r=a.body.length;g<r;g++){var c=a.body[g],h=b=null,e=!1,n=!1;l.isFunc(c)&&(c=c());if(null==c)e=!0;else{var k=l.isArr(c),p=k?!1:l.isObj(c);if(k)c.length?l.isArr(c[0])?n=!0:l.isFunc(c[0])?b=c[2]:(h=q(c,a,g,f),b=h.key):e=!0;else if(p)if(l.isFunc(c.redraw))c.moveTo(a,g),h=c.node,b=c.view[2];else{a.body[g--]=""+c;continue}else""===c?e=!0:0<g&&a.body[g-1].type===l.TYPE_TEXT?(a.body[g-1].body+=""+c,e=!0):h=q(""+c,a,g,f)}e||n?(n?l.insertArr(a.body,c,g,1):a.body.splice(g,
1),r=a.body.length,g--):(l.isVal(b)&&(d[b]=g,x=!0),a.body[g]=h||c)}x&&(a.keyMap=d)}return a}function m(a,d){d&&v(a.hooks,"Recycle",e,[d,a]);if(l.isArr(a.body)){var b=0;a.body.forEach(function(f,c){var h=l.isArr(f);if(d){var r=n(f,a,d,b);if(null!==r){var g=r[0],r=r[1];g===b&&b++;g=d.body[g];h&&g.vm?2===r?g.vm.moveTo(a,c,f[3]):1===r&&w(f[0],f[1],f[2],f[3],f[4],a,c):a.body[c]=m(f,g);return}}h?w(f[0],f[1],f[2],f[3],f[4],a,c):a.body[c]=m(f)})}return a}function h(a,d,b){var f=!a.el;if(a.type==l.TYPE_ELEM)if(f&&
(a.el=d&&d.nodeName?d:a.ns?D.createElementNS(I[a.ns],a.tag):D.createElement(a.tag),a.props&&F(a)),l.isArr(a.body)){d=0;for(var c=a.el.firstChild;d<a.body.length;d++)c=h(a.body[d],null,c)?c:c.nextSibling||null}else f&&l.isVal(a.body)&&(a.raw?a.el.innerHTML=a.body:a.el.textContent=a.body);else a.type==l.TYPE_TEXT&&f&&(a.el=D.createTextNode(a.body));a.el._node=a;if(b===a.el)return!1;if((d=a.parent)&&d.el)return v(a.hooks,f?"Insert":"Reinsert",A,[a,b]),!0}function A(a,d){a.parent.el.insertBefore(a.el,
d)}function n(a,d,b,f,c){var h=l.isArr(a),r=h?a[2]||null:a.key,g=b.keyMap,e=d.keyMap;b=b.body;d=d.body;if(null!==r&&g&&l.isVal(g[r]))return[g[r],2];f=f||0;if(f>b.length-1)return null;c=0===c?0:c||b.length-1;for(r=null;f<=c;f++)if(g=b[f],null!==g&&g.el)if(h&&g.vm){if(g.vm.view[0]===a[0]){if(g.vm.view[1]===a[1])return[f,2];var n=!1;if(C.viewScan)for(var k=0;k<d.length;k++){var m=d[k];if(!m.el&&m.vm&&m.vm.view[0]===g.vm.view[0]&&m.vm.view[1]===g.vm.view[1]){n=!0;break}}n||r||!e||l.isVal(e[g.key])||(r=
[f,1])}}else if(!(a.type!==g.type||a.type!==l.TYPE_TEXT&&(null===a.tag||a.tag!==g.tag)||null!==g.key&&e&&l.isVal(e[g.key])))return[f,1];return r}function e(a,d){d.el=a.el;a.el=null;if(d.type===l.TYPE_TEXT&&d.body!==a.body)d.el.nodeValue=d.body;else{F(d,a);var b=!l.isArr(d.body),f=!l.isArr(a.body);b&&d.body!==a.body?f&&d.el.firstChild?d.el.firstChild.nodeValue=d.body:d.raw?d.el.innerHTML=d.body:d.el.textContent=d.body:f&&!b&&(d.el.textContent="");a.moved=!0}}function v(a,d,b,f,c,h){if(a){var e=a["will"+
d];l.isArr(e)&&(e=e[0]);var g=a["did"+d];l.isArr(g)&&(g=g[0]);a=function(){b.apply(null,f);g&&g.apply(null,h||c||f)};e?(e=e.apply(null,c||f),l.isProm(e)?e.then(a):a()):a()}else b.apply(null,f)}function z(a){if(a in E)return E[a];var d={tag:null,id:null,"class":null};d.tag=a.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,function(a,b,c,e){c&&(d.id=c);e&&(d["class"]=e.replace(/\./g," ").trim());return b||"div"});return E[a]=d}function H(a,d,b,f){return function(c){var e;if(l.isFunc(a))e=a.call(d,
c,b,f);else if(l.isObj(a))for(var h in a)c.target.matches(h)&&(e=a[h].call(d,c,b,f));!1===e&&(c.preventDefault(),c.stopPropagation());f.opts.hasOwnProperty("watch")&&f.opts.watch.fire({vm:f})}}function F(a,d){var b=!d;d=d||{};if(d.props||a.props){var f=d.props||{},c=a.props||{},e=f.style,h=c.style;if(l.isObj(e)||l.isObj(h))B(a.el,e||{},h||{},J,K,a.ns,b),f.style=c.style=null;B(a.el,f,c,L,G,a.ns,b);h&&(c.style=h)}}function B(a,d,b,f,c,e,h){for(var g in b)null!==b[g]&&(g in d&&b[g]===d[g]||f(a,g,b[g],
e,h));for(g in d)null!==d[g]&&(g in b||c(a,g,e,h))}function J(a,d,b){a.style[d]=isNaN(b)||M[d]?b:b+"px"}function K(a,d){a.style[d]=""}function L(a,d,b,e,c){"."===d[0]?(d=d.substr(1),"svg"===e?a[d].baseVal=b:a[d]=b):"class"===d?a.className=b:"id"===d||l.isEvProp(d)?a[d]=b:!1===b?G(a,d,e,c):(!0===b&&(b=""),a.setAttribute(d,b))}function G(a,d,b,e){e||("."===d[0]?(d=d.substr(1),"svg"===b?a[d].baseVal=null:a[d]=null):"class"===d?a.className="":"id"===d||l.isEvProp(d)?a[d]=null:a.removeAttribute(d))}var I=
{svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},E={},D="undefined"==typeof document?{}:document,M={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,
widows:!0,zIndex:!0,zoom:!0},C={useRaf:!0,viewScan:!1,useDOM:!1};u.view=w;u.config=function(a){C=a};var l=u.util;return u})(domvm);(function(u){var w=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,t=u.util;u.html=function(b){var k="";switch(b.type){case t.TYPE_ELEM:k+="<"+b.tag;if(b.props){var q=t.isVal(b.props.style)?b.props.style:"",m=t.isObj(b.props.style)?b.props.style:null;if(m)for(var h in m)null!==m[h]&&(q+=t.camelDash(h)+": "+m[h]+";");for(h in b.props)t.isEvProp(h)||(m=b.props[h],t.isFunc(m)&&(m=m()),t.isObj(m)||(!0===m?k+=" "+h:!1!==m&&null!==m&&"."!==h[0]&&(k+=" "+h+'="'+
m+'"')));q.length&&(k+=' style="'+q+'"')}if(b.ns&&"svg"!==b.tag&&"math"!==b.tag&&!b.body)return k+"/>";k+=">";break;case t.TYPE_TEXT:return b.body}w.test(b.tag)||(t.isArr(b.body)?b.body.forEach(function(b){k+=u.html(b)}):k+=b.body||"",k+="</"+b.tag+">");return k}})(domvm);(function(u){var w=u.util;u.watch=function(t){function b(){}function k(h,k,n,e,v){v=v||{};v.method=(v.method||h).toUpperCase();if(null!==n){var z=Object.prototype.toString.call(n);"[object Array]"===z||"[object Object]"===z?(v.headers=v.headers||new Headers,v.headers.set("Content-Type","application/json"),v.body=JSON.stringify(n)):v.body=""+n}var z=e,q=b;e instanceof Array&&(z=e[0],e[1]&&(q=e[1]));e=fetch(k,v).then(function(b){if(200<=b.status&&300>b.status)return b;var e=Error(b.statusText);e.resp=
b;throw e;}).then(function(b){switch(b.headers.get("Content-Type").split("; ")[0]){case "application/json":return b.json();case "text/plain":return b.text();default:return b}}).then(z,q).then(function(b){!1!==b&&m.fire();return b},b);e._fetchArgs=[h,k,n,[z,q],v];return e}var q=[];w.isFunc(t)&&q.push(t);var m={on:function(b){q.push(b);return m},off:function(b){q.splice(q.indexOf(b),1);return m},fire:function(){w.execAll(q,arguments);return m},prop:function(h,q){var n=h,e=function(b,e){arguments.length&&
b!==n&&(n=b,!1!==e&&m.fire());return n};if(q&&q.then){e.update=b;if(q._fetchArgs){var v=q._fetchArgs[3];q._fetchArgs[3]=[function(b){return e(v[0]?v[0](b):b)},v[1]];e.update=function(){k.apply(null,q._fetchArgs)}}q.then(e)}return e.toString=e},sync:function(b,k,n){var e=b,m=k;"string"==typeof b&&(e=function(e){return"e."===b.substr(0,2)?e[b.substr(2)]:e.target[b]});return function(b){var h=this!==window?this:null;h&&"string"==typeof k&&(m=function(b,e){var n=h[k];h[k]=b;t&&b!==n&&!1!==e&&t()});m(e(b),
n)}},get:function(b,m,n){return k("get",b,null,m,n)},"delete":function(b,m,n){return k("delete",b,null,m,n)},post:function(b,m,n,e){return k("post",b,m,n,e)},put:function(b,m,n,e){return k("put",b,m,n,e)},patch:function(b,m,n,e){return k("patch",b,m,n,e)}};return m}})(domvm);(function(u){u.route=function(u,t){function b(b,e){var h=A[b],k=h.url;if(e&&-1!==k.indexOf(":")){e=e.slice();var m=!0,k=k.replace(/:([^\/]+)/g,function(b,k){var n=e.shift();if(h.params&&h.params[k]){if((""+n).match(h.params[k]))return n;m=!1}else return n});return m?k:m}return k}var k=!0,q={href:function(){var h=arguments,e=function(b){q["goto"].apply(null,h);b.preventDefault()};e.url=b.apply(null,h);return e},"goto":function(n,e,q){e=e||[];q=q||k;var t=b(n,e);if(!1===t)console.log("Could not find route");
else{for(var u=null,w=0;w<h.length;w++)if(h[w].url===t){u=w;break}null===u&&(h.splice(m+1,1E4),h.push({name:n,route:A[n],params:e,url:t}),u=h.length-1);w=h[u];Array.prototype.slice.call(arguments);var B=!0;null!==m&&(B=h[m].route.onexit.call(null,h[u].params.concat(w)));!1!==B&&!1!==h[u].route.onenter.apply(null,e.concat(h[m]))&&(history[q?"replaceState":"pushState"]([n,e],"title",t),m=u);k=!1}},current:function(){return h[m]}},m=null,h=[],A=u(q,t);window.onpopstate=function(b){q["goto"].apply(null,
b.state.concat(!0))};return q}})(domvm);
