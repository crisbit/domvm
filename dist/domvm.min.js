/*
 https://github.com/leeoniya/domvm (1.x-dev)
*/
("undefined"!==typeof global?global:this).domvm={};(function(x){var t=("undefined"==typeof window?{}:window).requestAnimationFrame,w={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},m={TYPE_ELEM:1,
TYPE_TEXT:2,isArr:function(c){return c instanceof Array},isVal:function(c){c=typeof c;return"string"===c||"number"===c},isObj:function(c){return"object"===typeof c&&null!==c&&!m.isArr(c)},isFunc:function(c){return"function"===typeof c},isProm:function(c){return"object"===typeof c&&m.isFunc(c.then)},isElem:function(c){return c instanceof HTMLElement},execAll:function(c,d,h,a,q,n){var p;c&&(m.isArr(c)?c:[c]).forEach(function(c){p=c.call(null,d,h,a,q,n)});return p},tick:function(c,d){d&&t?t&&t(function(){m.tick(c,
d-1)}):m.isArr(c)?c[0].apply(null,c.slice(1)):c()},insertArr:function(c,d,h,a){c.splice.apply(c,[h,a].concat(d))},isEvProp:function(c){return"on"===c.substr(0,2)},isDynProp:function(c,d){switch(c){case "input":case "textarea":case "select":case "option":switch(d){case "value":case "checked":case "selected":case "selectedIndex":return!0}}},camelDash:function(c){return c.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},autoPx:function(c,d){return isNaN(d)||w[c]?d:d+"px"},cmpArr:function(c,d){var h=
c.length;if(h!=d.length)return!1;for(;h--;)if(c[h]!==d[h])return!1;return!0},deepSet:function(c,d,h,a,q,n){d=d.split(".");var p=d.pop();d.forEach(function(a){c[a]||(c[a]={});c=c[a]});if(m.isFunc(c[p]))c[p](h,a,q,n);else c[p]=h},deepGet:function(c,d){var h=d.split(".");do c=c[h.shift()];while(h.length);return c},keyedIdx:function(c,d,h,a,q){for(a=0;a<d.length;a++)if(q=d[a],q.key===c)if(h){if(q.vm&&q.vm.view[0]===h)return a}else return a;return-1},raft:function(c){function d(){h=0;c.apply(a,q)}if(!t)return c;
var h,a,q;return function(){a=this;q=arguments;h||(h=t(d))}}};x.utils=m})(domvm);(function(x){function t(){for(var b;b=K.pop();)b[0].apply(null,b.slice(1))}function w(b,f){return!1===f?null:null==f&&null!=b?b:l.isVal(f)||l.isObj(f)||l.isArr(f)||l.isFunc(f)?f:null}function m(b,f,z,a,e,E){function k(b,f,e){if(e)b[f]=b[f]||[],b[f].push(e);else for(var c in f)b[c]=b[c]||[],b[c].push(f[c])}function v(b,f,c){e=b;E=f;r.update(c,!1);null!=r.node&&(e.body[E]=r.node);return u(0,!1)}function m(b){return null==b?"":b}function u(b,c){if(b){for(var a=r;b--&&a.parent;)a=a.parent;a.redraw(0,
!0);return a.vm}(a=r.node)&&d(r,"willRedraw",r);var y=r.refs;r.refs={};var g=r.render.call(r.api,r,f,z);if(!1===g)return r.node.moved=!0,r.node.wasSame=!0,r.refs=y,r;y=q(g,e,E,r);y.vm=r;r.node=y;g=l.isVal(z)&&"^"===z[0]?z.substr(1):l.isVal(y.ref)&&"^"===y.ref[0]?y.ref.substr(1):null;y.key=null!=z?z:y.key;for(var v=e;v;)v.vm&&(r.parent||(r.parent=v.vm),null!==g&&l.deepSet(v.vm.refs,g,y)),v=v.parent;if((g=a)&&(y.type!==a.type||y.tag!==a.tag))var g=null,k=!0,m=a.el.parentNode;n(y,g);e&&(e.body[E]=y);
!1!==c&&(a&&h(a),!a&&D||p(y,null,y.el),k&&(m||y.parent.el).insertBefore(y.el,m.childNodes[a.idx]));a&&d(r,"didRedraw",r);!1!==c&&l.tick(t,2);return r}var D=!e;l.isArr(b)&&(f=b[1],z=b[2],a=b[3],b=b[0]);z=w(f,z);var r={api:{},node:null,view:[b,z],model:f,opts:a||{},render:null,update:function(b,e){null==b||z===f&&!l.isVal(z)||(f=r.model=b);return!1!==e?u(0):r},on:function(b,f){k(r.events,b,f)},hook:function(b,f){r.hooks=r.hooks||{};k(r.hooks,b,f)},events:{},hooks:null,redraw:I.useRaf?l.raft(u):u,patch:function(b,
f){var e=null!=b.el;if(l.isObj(f)){var c="class"in f?(m(b["class"])+" "+m(f["class"])).trim():b.props["class"],a="style"in f?f.style:b.props.style;e&&(e=Object.create(b.props),e["class"]=c,e.style=a,e={tag:b.tag,el:b.el,ns:b.ns,props:e},g(e,b));b.props["class"]=c;b.props.style=a}else c=b.parent,e=n(q(f,c,b.idx,r),b),c.body[b.idx]=e},emit:function(b){for(var f=Array.prototype.slice.call(arguments),e=r,c;e;){if(c=e.events[b]){f[0]=c;l.execAll.apply(null,f);break}e=e.parent}},refs:{},parent:null,mount:function(b,
f){var e=null;f&&(b.textContent="",e=b,b=null);p(r.node,e,null,b);return r},attach:function(b){c(r.node,b);return r},unmount:function(){h(r.node)},moveTo:v,updIdx:function(b){E=b}};a&&a.hooks&&r.hook(a.hooks);l.execAll(F,r);r.render=b.call(r.api,r,f,z);return e?v(e,E):u(0)}function c(b,f){b.el=f;f._node=b;for(var a in b.props){var y=b.props[a],e=l.isEvProp(a)?a:"."===a[0]?a.substr(1):null;null!==e&&(f[e]=y)}if(l.isArr(b.body))for(a=0;a<b.body.length;a++)c(b.body[a],f.childNodes[a])}function d(b,f,
c,a,e,g){if(b&&b.hooks&&(b=b.hooks[f]))if(I.useRaf&&"did"==f.substr(0,3))K.push([l.execAll,b,c,a,e,g]);else return l.execAll(b,c,a,e,g)}function h(b,f){var c=b.el&&!b.moved;if(c){var y=d(b.vm,"willUnmount",b.vm),e=d(b,"willRemove",b),g=y||e;b.removed=!0}b.wasSame?b.wasSame=!1:(l.isArr(b.body)&&b.body.forEach(function(b,e){h(b,f||g)}),f||(g?g.then(function(){a(b,c)}):a(b,c)));b.moved=!1}function a(b,f){null!=b.el&&b.el.parentNode&&(f&&(b.el.parentNode.removeChild(b.el),b.el=null,d(b.vm,"didUnmount",
b.vm),d(b,"didRemove",b)),l.isArr(b.body)&&b.body.forEach(function(b,f){a(b,!b.moved)}))}function q(b,f,c,a){var e=b;b={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,wasSame:!1,removed:!1,hooks:null,tag:null,"class":null,ns:null,guard:!1,raw:!1,props:null,el:null,hasKeys:!1,body:null};l.isFunc(e)&&(e=e());var g=e.length;if(l.isArr(e)&&g){b.type=l.TYPE_ELEM;if(1<g){var k=1;l.isObj(e[1])&&!l.isElem(e[1])&&(b.props=e[1],k=2);b.body=g==k+1?l.isVal(e[k])?e[k]:l.isFunc(e[k])?e[k]():e.slice(k):
e.slice(k)}e=e[0];g=L[e];g||(g=["",""],g={tag:(e.match(/^[-\w]+/)||["div"])[0],id:(e.match(/#([-\w]+)/)||g)[1],"class":(e.match(/\.([-\w.]+)/)||g)[1].replace(/\./g," ")},L[e]=g);b.tag=g.tag;if(g.id||g["class"])e=b.props||{},g.id&&null==e.id&&(e.id=g.id),g["class"]&&(b["class"]=g["class"],e["class"]=g["class"]+(null!=e["class"]?" "+e["class"]:"")),b.props=e;if(b.props){var e=b.props,v;for(v in e)!l.isEvProp(v)&&l.isFunc(e[v])&&("href"==v?(e.onclick=e[v],e.href=e[v].href):e[v]=e[v]()),l.isDynProp(b.tag,
v)&&(e["."+v]=e[v]);if(l.isObj(e.style))for(var d in e.style)v=e.style[d],l.isFunc(v)&&(e.style[d]=v());l.isObj(e._hooks)&&(b.hooks=e._hooks,e._hooks=null);b.key=l.isVal(e._key)?e._key:l.isVal(e._ref)?e._ref:l.isVal(e.id)?e.id:l.isVal(e.name)?e.name:null;null!=e._ref&&(b.ref=e._ref);e._raw&&(b.raw=!0);null!=e._data&&(b.data=e._data);e._ref=e._key=e._raw=e._data=null}}else l.isVal(e)?(b.type=l.TYPE_TEXT,b.body=e):l.isElem(e)&&(b.type=l.TYPE_ELEM,b.el=e,b.tag=e.nodeName.toLowerCase());null!==b.ref&&
l.deepSet(a.refs,b.ref,b);b.parent=f;b.idx=c;b.ns=f&&f.ns?f.ns:"svg"===b.tag||"math"===b.tag?b.tag:null;if(l.isArr(b.body))for(f=0,c=b.body.length;f<c;f++){d=b.body[f];e=v=null;k=g=!1;l.isFunc(d)&&(d=d());if(null==d)g=!0;else{var h=l.isArr(d),n=h?!1:l.isObj(d);if(h)d.length?"string"==typeof d[0]&&""!==d[0]?(e=q(d,b,f,a),v=e.key):l.isFunc(d[0])?v=w(d[1],d[2]):k=!0:g=!0;else if(n)if(l.isFunc(d.redraw))d.moveTo(b,f),e=d.node,v=d.view[1];else if(l.isElem(d))e=q(d,b,f,a);else{b.body[f--]=""+d;continue}else""===
d?g=!0:0<f&&b.body[f-1].type===l.TYPE_TEXT?(b.body[f-1].body+=""+d,g=!0):e=q(""+d,b,f,a)}g||k?(k?l.insertArr(b.body,d,f,1):b.body.splice(f,1),c=b.body.length,f--):(null!==v&&(b.hasKeys=!0),b.body[f]=e||d)}return b}function n(b,f){f&&(d(b,"willRecycle",f,b),D(f,b),d(b,"didRecycle",f,b));if(l.isArr(b.body)){var c=0;b.body.forEach(function(a,e){var g=l.isArr(a);if(f){var d=u(a,b,f,c);if(null!==d){var k=d[0],d=d[1];k===c&&c++;k=f.body[k];k.vm?g?2===d?k.vm.moveTo(b,e,a[1]):1===d&&m(a[0],a[1],a[2],a[3],
b,e):a.vm&&2===d&&a.vm===k.vm&&k.vm.moveTo(b,e):b.body[e]=n(a,k);return}}g?m(a[0],a[1],a[2],a[3],b,e):b.body[e]=n(a)})}return b}function p(b,f,a,c){for(var e=!b.el;a&&a._node.removed;)a=a.nextSibling;e&&d(b.vm,"willMount",b.vm);if(b.type==l.TYPE_ELEM)if(e&&(b.el=f||(b.ns?C.createElementNS(J[b.ns],b.tag):C.createElement(b.tag)),b.props&&g(b)),l.isArr(b.body)){f=0;for(var k=b.el.firstChild;f<b.body.length;f++)k=p(b.body[f],null,k)}else l.isVal(b.body)&&(b.raw?b.el.innerHTML=b.body:e&&(b.el.textContent=
b.body));else b.type==l.TYPE_TEXT&&e&&(b.el=C.createTextNode(b.body));b.el._node=b;f=b.parent;a!==b.el&&(c||f&&f.el)&&(f=e?"Insert":"Reinsert",d(b,"will"+f,b),(c||b.parent.el).insertBefore(b.el,a),d(b,"did"+f,b));e&&b.vm&&b.vm.hooks&&!b.moved&&d(b.vm,"didMount",b.vm);return a!==b.el?a:a.nextSibling}function u(b,f,a,c,e){var g=l.isArr(b),d=g?w(b[1],b[2]):b.key,k=a.hasKeys,q=f.hasKeys;a=a.body;f=f.body;if(null!==d&&k)return b=l.keyedIdx(d,a,g?b[0]:null),-1<b?[b,2]:null;c=c||0;if(c>a.length-1)return null;
e=0===e?0:e||a.length-1;for(d=null;c<=e;c++)if(k=a[c],null!==k&&k.el)if(g&&k.vm){if(k.vm.view[0]===b[0]){if(k.vm.view[1]===w(b[1],b[2]))return[c,2];!d&&q&&-1==l.keyedIdx(k.key,f,k.vm.view[0])&&(d=[c,1])}}else if(b.type===k.type&&(b.type===l.TYPE_TEXT||null!==b.tag&&b.tag===k.tag)&&(null===k.key||!q||-1==l.keyedIdx(k.key,f,k.vm?k.vm.view[0]:null)))return[c,1];return d}function D(b,f){f.el=b.el;b.el=null;f.el&&(f.el._node=f);if(f.type===l.TYPE_TEXT&&f.body!==b.body)f.el.nodeValue=f.body;else{g(f,b);
var a=!l.isArr(f.body),c=!l.isArr(b.body);a&&f.body!==b.body?c&&f.el.firstChild?f.el.firstChild.nodeValue=f.body:f.raw?f.el.innerHTML=f.body:f.el.textContent=f.body:c&&!a&&(f.el.textContent="");b.moved=!0}}function A(b,f,a,c){return function(a){var g,d=a.target._node,k=null;if(l.isFunc(b))g=b.call(f,a,d,c);else if(l.isArr(b))k=b.slice(1),g=b[0].apply(f,k.concat(a,d,c));else if(l.isObj(b))for(var q in b){var h=b[q];null!=h&&"_"!=q[0]&&a.target.matches(q)&&(l.isArr(h)?(k=h.slice(1),g=h[0].apply(f,k.concat(a,
d,c))):l.isFunc(h)&&(g=h.call(f,a,d,c)))}!1===g&&(a.preventDefault(),a.stopPropagation());c.opts.hasOwnProperty("watch")&&c.opts.watch.fire({type:"event",vm:c,node:d,event:a,data:k})}}function g(b,a){var c=!a;a=a||{};if(a.props||b.props){var g=a.props||{},e=b.props||{},d=g.style,q=e.style;if(l.isObj(d)||l.isObj(q))k(b.el,b.tag,d||{},q||{},G,M,b.ns,c,b),g.style=e.style=null;k(b.el,b.tag,g,e,B,H,b.ns,c,b);q&&(e.style=q)}}function k(b,a,c,g,e,d,k,q,h){for(var n in g)if(a=g[n],null!==a){var p="."===n[0]?
b[n.substr(1)]:c[n];a===p||l.isArr(a)&&l.isArr(p)&&l.cmpArr(a,p)||e(b,n,a,k,q,h)}for(n in c)null!==c[n]&&null==g[n]&&d(b,n,k,q)}function G(b,a,c){b.style[a]=l.autoPx(a,c)}function M(b,a){b.style[a]=""}function B(b,a,c,g,e,d){if("."===a[0])a=a.substr(1),"svg"===g?b[a].baseVal=c:b[a]=c;else if("class"===a)b.className=c;else if("id"===a)b[a]=c;else if(l.isEvProp(a)){for(g=d;!g.vm;)g=g.parent;b[a]=A(c,g.vm.opts.evctx||g.vm.model||null,d,g.vm)}else!1===c?H(b,a,g,e):b.setAttribute(a,!0===c?"":c)}function H(b,
a,c,g){g||("."===a[0]?(a=a.substr(1),"svg"===c?b[a].baseVal=null:b[a]=null):"class"===a?b.className="":"id"===a||l.isEvProp(a)?b[a]=null:b.removeAttribute(a))}var J={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},C="undefined"==typeof document?{}:document,L={},K=[],I={useRaf:!0};x.view=m;x.view.config=function(b){I=b};var F=null;x.view.extend=function(b,a){F=!F||a?[]:F;F.push(b)};var l=x.utils;return x})(domvm);(function(x){var t=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,w=x.utils;x.html=function(m){var c="";switch(m.type){case w.TYPE_ELEM:c+="<"+m.tag;if(m.props){var d=w.isVal(m.props.style)?m.props.style:"",h=w.isObj(m.props.style)?m.props.style:null;if(h)for(var a in h)null!==h[a]&&(d+=w.camelDash(a)+": "+w.autoPx(a,h[a])+"; ");for(a in m.props)w.isEvProp(a)||"."===a[0]||(h=m.props[a],w.isFunc(h)&&(h=h()),w.isObj(h)||(!0===h?c+=" "+a:!1!==h&&null!==h&&
"."!==a[0]&&(c+=" "+a+'="'+h+'"')));d.length&&(c+=' style="'+d.trim()+'"')}if(m.ns&&"svg"!==m.tag&&"math"!==m.tag&&!m.body)return c+"/>";c+=">";break;case w.TYPE_TEXT:return m.body}t.test(m.tag)||(w.isArr(m.body)?m.body.forEach(function(a){c+=x.html(a)}):c+=m.body||"",c+="</"+m.tag+">");return c}})(domvm);(function(x){var t=x.utils;x.watch=function(w){function m(){}function c(a,c,d,p,u){u=u||{};u.method=a.toUpperCase();"credentials"in u||(u.credentials="same-origin");null!==d&&(t.isArr(d)||t.isObj(d)?(u.headers=u.headers||new Headers,u.headers.set("Content-Type","application/json"),u.body=JSON.stringify(d)):u.body=""+d);var D=p,A=m;p instanceof Array&&(D=p[0],p[1]&&(A=p[1]));var g={type:"fetch",fetch:{method:a,url:c,body:d}};p=fetch(c,u).then(function(a){if(200<=a.status&&300>a.status)return a;var c=
Error(a.status+": "+a.statusText);c.data=a;return Promise.reject(c)}).then(function(a){switch(a.headers.get("Content-Type").split("; ")[0]){case "application/json":return a.json();case "text/plain":return a.text();default:return a}}).then(D,A).then(function(a){!1!==a&&h.fire(g);return a},function(a){g.error=a;h.fire(g);return a});p._fetchArgs=[a,c,d,[D,A],u];return p}var d=[];t.isFunc(w)&&d.push(w);var h={on:function(a){d.push(a);return h},off:function(a){d.splice(d.indexOf(a),1);return h},fire:t.raft(function(a){t.execAll(d,
a);return h}),prop:function(a,d){var n=a,p=function(a,c,g){if(arguments.length&&a!==n){var d=n;n=a;g=g||{type:"prop",prop:p,data:{old:d,"new":a}};t.isFunc(c)?c(g):!1!==c&&h.fire(g)}return n};p._prop=!0;if(d&&d.then){p.update=m;if(d._fetchArgs){var u=d._fetchArgs[3];d._fetchArgs[3]=[function(a){return p(u[0]?u[0](a):a)},u[1]];p.update=function(){c.apply(null,d._fetchArgs)}}d.then(p)}return p.toString=p},sync:function(a,c,d){var p=a,m=c;t.isFunc(p)||(p=function(c,d,g){if("string"==typeof a){var k,h;
"e."==a.substr(0,2)?(k=c,h=a.substr(2)):(k=c.target,h=a)}return t.deepGet(k,h)});t.isArr(m)&&(m=function(a,d,g){var k=c[0],n=c[1];t.isFunc(n)&&(n=n(g.event,g.node,g.vm));var p=t.deepGet(k,n);a!==p&&(t.deepSet(k,n,a,d,g),t.isFunc(d)?d(g):!1!==d&&h.fire(g))});return function(a,c,g){var k={type:"sync",vm:g,node:c,event:a};m(p(a,c,g),d,k)}},fetch:c,get:function(a,d,n){n?a+=h.query(d):n=d;return c("get",a,null,n)},"delete":function(a,d,n){n?a+=h.query(d):n=d;return c("delete",a,null,n)},post:function(a,
d,h){return c("post",a,d,h)},put:function(a,d,h){return c("put",a,d,h)},patch:function(a,d,h){return c("patch",a,d,h)},query:function(a){if(!t.isObj(a))return"";var c=[],d=encodeURIComponent,h;for(h in a)c.push(d(h)+"="+d(a[h]));return c.length?"?"+c.join("&"):""}};return h}})(domvm);(function(x){function t(a,c,d,h,m,t){var w=null,g=null,k=null;if("/"==d[0]){k=d;g=!1;h={};t=k.split("#");c=t[0].split("?");w=c[0];t=t[1];c[1]&&(m={},c[1].split("&").map(function(a){a=a.split("=");m[a[0]]=null==a[1]?!0:a[1]}));var G,x;for(x in a){d=a[x];var B=d.path;if(G=w.match(d.regexPath)){g=x;-1!==B.indexOf(":")&&(h={},G.shift(),B.replace(/:([^\/]+)/g,function(a,c){h[c]=G.shift()}));break}}}else{g=d;d=a[g];var B=c+d.path,H=d.vars||{},J=/^[^\/]+$/,k=-1!==B.indexOf(":")?w=B.replace(/:([^\/]+)/g,
function(a,c){if((H[c]||J).test(h[c]))return h[c]+="";throw Error("Invalid value for route '"+B+"' segment '"+c+"': '"+h[c]+"'");}):w=B;if(m){var k=k+"?",C;for(C in m)k+=C+(!0!==m[C]?"="+m[C]:"")+"&";k=k.slice(0,-1)}k+=t?"#"+t:""}return{href:k,name:g,path:w,segs:h,hash:t,query:m}}function w(a,c){for(var d in a){var h=a[d];h.regexPath=new RegExp("^"+c+h.path.replace(/:([^\/]+)/g,function(a,c){var d=""+h.vars[c];return"("+d.substring(1,d.lastIndexOf("/"))+")"})+"$")}}var m=[],c=null,d=!1,h="";x.route=
function(a,q){function n(){var a=location,a=d?a.href.substr(a.origin.length):a.hash.substr(1)||"/";return t(A,h,a)}var p=null,u={href:function(a,c,m,n,p){var q=t(A,h,a,c,m,n);return d?(a=function(a){u["goto"](q,null,null,null,p);a.preventDefault()},a.href=q.href,a):"#"+q.href},config:function(a){(d=a.useHist)&&(h=a.root||"");p=a.init||null},refresh:function(){u["goto"](n(),null,null,null,!0)},"goto":function(a,k,n,p,q){q=q||x;a.href||(a=t(A,h,a,k,n,p));if(!1===a.name)console.log("Could not find route");
else{k=null;for(n=0;n<m.length;n++)if(m[n].href===a.href){k=n;break}null===k&&(m.splice(c+1,1E4),m.push(a),k=m.length-1);a=m[c];n=m[k];p=!0;null!==c&&(p=(p=A[a.name].onexit)?p.apply(null,(a?[a.segs,a.query,a.hash]:[]).concat(n)):!0);if(!1!==p&&!1!==A[n.name].onenter.apply(null,(n?[n.segs,n.query,n.hash]:[]).concat(a))){if(d)history[q?"replaceState":"pushState"](null,"title",n.href);c=k}x=!1}},location:function(){return x?n():m[c]}},x=!0,A=a(u,q);w(A,h);window.onhashchange=window.onpopstate=function(a){(d||
"popstate"!=a.type)&&u["goto"](n(),null,null,null,!0)};p&&p();return u}})(domvm);
